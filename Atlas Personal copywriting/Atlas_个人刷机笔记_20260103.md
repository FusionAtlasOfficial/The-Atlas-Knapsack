# 《2026安卓救砖/刷机/备份入门知识超级汇总 & 小米12Pro刷机笔记》

# 关于上传平台

各大网站对于 Markdown 格式的支持以及标准都有所差异，排版可能有一些问题，会慢慢修改的。

本文首发于：

* Github 个人仓库：[【The-Atlas-Knapsack】](https://github.com/FusionAtlasOfficial/The-Atlas-Knapsack/tree/main)
  * 本文的目标是上传于多个平台，但不同平台的政策和偏好完全不同，不见得每个平台上都能上传完整内容，故 Github 上的版本为线上原始存档。

--- 

# 前言

作为互联网早期原住民的一份子，虽然未有幸见证中文互联网出生时最原初的样子，但我依旧亲历了这个世界如何从一片混沌的处女地中发展、壮大，也眼睁睁的看着这个几乎承载了自己前半生的世界，如何开始分崩离析、如何变得满目疮痍，乃至如今的群雄割据、了无生机。

本文作者是一个纯野路子自学的IT爱好者，深知自身基础知识的不足，尤其是编程层面也就勉强摆脱麻瓜级别，网络冲浪20多年，刮搜了一大堆软件、脚本，还有各路妙妙小工具，自己却依旧没系统性的学完一门编程语言。

但与此同时，超过20多年网络冲浪的资历又让自己很容易陷入自傲的情绪。

**进而高估自身对深度成体系“系统性知识”的领悟能力。**

在一个月前误入安卓系统深水区却有侥幸爬上岸后，一种迫切的危机感涌上心头，我必须要写笔记了...这次不能再懒惰下去了，我绝不能成为儿时自己眼中的那些油腻中年人...

每次自己照着教程操作，遇上问题就去全网各个领域高强度搜索，然后再盲试更多的教程，虽然以我对自身搜商及耐性的自信心，绝大多数时候都真的走到了最后解决了问题，但事后回想，往往是自己的知识体系才刚有了有阶段性进展就翻篇了，甚至还会“叉会儿腰吧，哎呀我可真牛逼”。

由于盲目自信，把细微的小问题越修越大，导致一连串的作死决策，最终滚雪球到抽自己耳光的境地，这类事在作者身上已经发生了不止一次，仅仅是“知其然”，却总是自以为做到了“知其所以然”，这让我深刻认识到一个我自己都说烂了的道理：“别拿战术上的勤奋，掩盖战略上的懒惰”。

虽然最终结果是好的，但这次我必须要在自己脑子里整点系统性的东西，至少，不能辜负自己这又一次苦苦救砖红着眼睛熬出来的夜。

我的目标是通过写完此文，将大量自己之前一知半解的概念和知识梳理清楚，最初想写的其实仅仅“个人操作备忘”，但是越写越发现不对劲，写流水账只能产出傻瓜式教程，长远来看，弊远大于利。

写此文的另外一部分动机是，虽然部分疑难杂症即便是简中互联网也能找到解决经验，但基本是较为分散的碎片，而自己手头这台米12Pro的刷机全流程踩坑教训，全网确实也缺乏系统性的完整记录，值得梳理出来让后人借鉴，我已经从太多前人的优质信息中获益，是时候反哺点什么了。

最终全文近四万字，前后总耗时近一个月，算是笔者竭尽所能追求详尽完整而写的刷机教程汇总文，不敢说多么深刻全面，但至少力求准确，同时尽可能提高可读性。

必须得承认，本文前期准备阶段前期用了Gemini 3.0大模型提供方向、规划大纲，以及协助部分强跳跃性、强联想、类比文案的润色，这方面顶级大模型确实是超水准教师，极大帮助学习时理清思路，但中后期作者依旧使用纯粹肉脑花费大量精力进行增删改查，文中所有实质性内容皆为作者纯手工码字输出，教程相关的内容除非特别标注皆经过作者本人实测验证，如有问题则尽请指出。

我知道，在进入2026年的当下，整个消费电子领域都已经彻头彻尾的娱乐化、民粹化，“互联网精神”这种词如今更像是个远古笑话，此时写这种性质的刷机文章在很多人眼中都是注定费力不讨好，尤其在这个太多知识对老手来说属于“常识”而不屑于细致教学的时代，尤其在这个太多知识对新手来说属于“天书”而不屑于逐步了解的时代，尤其在这个刷机圈极大萎缩的时代。

但愿算是能尽绵薄之力，传一把火。

--- 

# 目录

本文写作时严格遵循 Markdown 语法，好处是显而易见的，对于我这种强迫症来说，重逻辑的长文梳理本就困难，如果再加上排版，几乎就是要命的事情。

而基于 Markdown 基本语法生成的展开目录则可以直观的展示文章结构，同时每条都是可点击直达的文章内链接，便于查阅。

- [《2026安卓救砖/刷机/备份入门知识超级汇总 \& 小米12Pro刷机笔记》](#2026安卓救砖刷机备份入门知识超级汇总--小米12pro刷机笔记)
- [关于上传平台](#关于上传平台)
- [前言](#前言)
- [目录](#目录)
- [第一章：安卓刷机的基本知识](#第一章安卓刷机的基本知识)
  - [1.1 刷机的基础门槛](#11-刷机的基础门槛)
  - [1.2 什么是刷机？](#12-什么是刷机)
  - [1.3 什么是“砖”？](#13-什么是砖)
  - [1.4 为什么要刷机？](#14-为什么要刷机)
    - [1.4.1 获取 Root 权限](#141-获取-root-权限)
    - [1.4.2 彻底卸载预装](#142-彻底卸载预装)
    - [1.4.3 摆脱厂商云控劣化/老机续命](#143-摆脱厂商云控劣化老机续命)
    - [1.4.4 极限优化性能 \& 续航](#144-极限优化性能--续航)
    - [1.4.5 玩第三方系统](#145-玩第三方系统)
    - [1.4.6 建立自救能力](#146-建立自救能力)
  - [1.5 安卓分区/系统架构概念](#15-安卓分区系统架构概念)
    - [1.5.1. 引导相关核心分区介绍](#151-引导相关核心分区介绍)
      - [1.5.1.1 Bootloader（引导加载程序）](#1511-bootloader引导加载程序)
      - [1.5.1.2 Boot（内核）](#1512-boot内核)
      - [1.5.1.3 System（系统）](#1513-system系统)
      - [1.5.1.4 Recovery（恢复）](#1514-recovery恢复)
      - [1.5.1.5 Vendor（供应商）](#1515-vendor供应商)
    - [1.5.2. 分区机制的断代史：教科书般的屎山代码](#152-分区机制的断代史教科书般的屎山代码)
      - [1.5.2.1 【传统分区】(Non-A/B / Only A) —— *Android 7.0 之前*](#1521-传统分区non-ab--only-a--android-70-之前)
      - [1.5.2.2 【A/B 分区】(Seamless Updates) —— *Android 7.0 ~ 9.0*](#1522-ab-分区seamless-updates--android-70--90)
      - [1.5.2.3 【动态分区】(Dynamic Partitions / VAB) —— *Android 10+ (主流现状)*](#1523-动态分区dynamic-partitions--vab--android-10-主流现状)
    - [1.5.3. 小结：变砖的简易诊断](#153-小结变砖的简易诊断)
- [第二章：刷机的完整逻辑](#第二章刷机的完整逻辑)
  - [2.1 第一阶段：备份+充满电 —— **制作“克隆体”，然后吃饱饭**](#21-第一阶段备份充满电--制作克隆体然后吃饱饭)
    - [2.1.1 系统内备份](#211-系统内备份)
    - [2.1.2 手动备份 sdcard 目录](#212-手动备份-sdcard-目录)
    - [2.1.3 把设备充满电](#213-把设备充满电)
  - [2.2 第二阶段：解BL锁 —— **获得“手术资格”**](#22-第二阶段解bl锁--获得手术资格)
    - [2.2.1 确认设备能够解 BL 锁](#221-确认设备能够解-bl-锁)
    - [2.2.2 解开 BL 锁 (Unlock Bootloader)](#222-解开-bl-锁-unlock-bootloader)
  - [2.3 第三阶段：环境通道搭建 —— **“术前准备”**](#23-第三阶段环境通道搭建--术前准备)
    - [2.3.1 Android SDK Platform-Tools —— **绝对权威“急诊中心”**](#231-android-sdk-platform-tools--绝对权威急诊中心)
    - [2.3.2 ADB (Android Debug Bridge) —— **通用标准“手术台”**](#232-adb-android-debug-bridge--通用标准手术台)
    - [2.3.3 驱动 (Drivers) —— **“护士、器械与技师”**](#233-驱动-drivers--护士器械与技师)
    - [2.3.4 Fastboot —— **“体外循环系统+超精密手术机械臂” (ECMO \& Surgical Robotic Arm)”**](#234-fastboot--体外循环系统超精密手术机械臂-ecmo--surgical-robotic-arm)
  - [2.4 第四阶段：刷入 —— **植入新的“器官”（甚至可以是旧的）**](#24-第四阶段刷入--植入新的器官甚至可以是旧的)
    - [2.4.1 刷入第三方Recovery（TWRP） —— **神经系统的强化改造**](#241-刷入第三方recoverytwrp--神经系统的强化改造)
      - [2.4.1.1 TWRP是什么？](#2411-twrp是什么)
      - [2.4.1.2 TWRP核心能力](#2412-twrp核心能力)
      - [2.4.1.3 TWRP的下载渠道](#2413-twrp的下载渠道)
      - [2.4.1.4 向设备内安装TWRP](#2414-向设备内安装twrp)
    - [2.4.2 卡刷 (Recovery Flashing) —— **“强化人”自助换脑复活**](#242-卡刷-recovery-flashing--强化人自助换脑复活)
    - [2.4.3 ADB Sideload —— **外部操控的微型手术机器人**](#243-adb-sideload--外部操控的微型手术机器人)
    - [2.4.4 线刷 (Fastboot / Tool Flashing) —— **“脑死亡尸体”上手术台换脑复活**](#244-线刷-fastboot--tool-flashing--脑死亡尸体上手术台换脑复活)
    - [2.4.5 高通9008模式/MTK深刷模式 —— **近乎于重生的超级人造子宫**](#245-高通9008模式mtk深刷模式--近乎于重生的超级人造子宫)
  - [2.5 第五阶段：防砖与急救 —— **亡羊补牢的“术后保险”**](#25-第五阶段防砖与急救--亡羊补牢的术后保险)
    - [2.5.1. 救砖工作量评估 —— **严重性诊断 + 手术规模评估**](#251-救砖工作量评估--严重性诊断--手术规模评估)
      - [2.5.1.1 进 TWRP 修改系统文件救砖 —— **轻伤**](#2511-进-twrp-修改系统文件救砖--轻伤)
      - [2.5.1.2 恢复出厂设置救砖 —— **中伤**](#2512-恢复出厂设置救砖--中伤)
      - [2.5.1.3 重新刷机（卡刷 or 线刷）救砖 —— **重伤**](#2513-重新刷机卡刷-or-线刷救砖--重伤)
      - [2.5.1.4 底层救砖（EDL / 9008） —— **濒死**](#2514-底层救砖edl--9008--濒死)
    - [2.5.2 搞机风险防控 —— **“术后恢复与疗养禁忌”**](#252-搞机风险防控--术后恢复与疗养禁忌)
      - [2.5.2.1 Root 权限 ≈ **神经中枢的最高指挥权**](#2521-root-权限--神经中枢的最高指挥权)
      - [2.5.2.2 Root 权限管理软件 (如 Magisk ) ≈ **排异抑制剂 + 体内药理师**](#2522-root-权限管理软件-如-magisk---排异抑制剂--体内药理师)
      - [2.5.2.3 检测 Root 的应用程序(如银行/支付App) ≈ **病毒、寄生器官**](#2523-检测-root-的应用程序如银行支付app--病毒寄生器官)
      - [2.5.2.4 Root 后的高危操作 —— **标准作死行为举例**](#2524-root-后的高危操作--标准作死行为举例)
  - [2.6 第六阶段：终局备份 —— **制作更强的克隆体**](#26-第六阶段终局备份--制作更强的克隆体)
    - [2.6.1. TWRP 备份的性质](#261-twrp-备份的性质)
    - [2.6.2. TWRP 备份前提](#262-twrp-备份前提)
    - [2.6.3. 备份相关核心分区介绍 + TWRP清除操作基本分类 —— **目标病灶确认**](#263-备份相关核心分区介绍--twrp清除操作基本分类--目标病灶确认)
      - [2.6.3.1 Cache（系统缓存）](#2631-cache系统缓存)
      - [2.6.3.2 Dalvik / ART Cache（虚拟机编译缓存）](#2632-dalvik--art-cache虚拟机编译缓存)
      - [2.6.3.3 System（系统）](#2633-system系统)
      - [2.6.3.4 Data（用户数据/真·内部存储）](#2634-data用户数据真内部存储)
      - [2.6.3.5 内部存储设备（sdcard分区/公共存储空间/真·外部存储）](#2635-内部存储设备sdcard分区公共存储空间真外部存储)
      - [2.6.3.6 USB-OTG（外置USB设备）](#2636-usb-otg外置usb设备)
    - [2.6.4 TWRP 备份分区选择](#264-twrp-备份分区选择)
      - [2.6.4.1 Boot (内核)](#2641-boot-内核)
      - [2.6.4.2 Data (用户数据)](#2642-data-用户数据)
      - [2.6.4.3 System / System Image (系统 / 系统镜像)](#2643-system--system-image-系统--系统镜像)
      - [2.6.4.4 Vendor / Vendor Image (供应商 / 供应商镜像)](#2644-vendor--vendor-image-供应商--供应商镜像)
      - [2.6.4.5 EFS / IMEI / Modem / Persist (底层隐私与基带)](#2645-efs--imei--modem--persist-底层隐私与基带)
      - [2.6.4.6 Super (超级分区)](#2646-super-超级分区)
      - [2.6.4.7 Recovery（恢复分区）](#2647-recovery恢复分区)
      - [2.6.4.8 Cache / Dalvik Cache (缓存)](#2648-cache--dalvik-cache-缓存)
    - [2.6.5 TWRP 备份后的数据转移](#265-twrp-备份后的数据转移)
  - [2.7 第七阶段：恢复 —— **复活！**](#27-第七阶段恢复--复活)
- [第三章：安卓刷机实战流程 + 疑难杂症解决方案（以小米12Pro为例）](#第三章安卓刷机实战流程--疑难杂症解决方案以小米12pro为例)
  - [3.0 第零阶段实操：关键信息整理记录](#30-第零阶段实操关键信息整理记录)
    - [3.0.1 原始硬件信息（刷机相关）](#301-原始硬件信息刷机相关)
    - [3.0.2 当前软件信息（刷机相关）](#302-当前软件信息刷机相关)
    - [3.0.3 刷机记录](#303-刷机记录)
  - [3.1 第一阶段实操：备份+充满电](#31-第一阶段实操备份充满电)
    - [3.1.1 系统内备份](#311-系统内备份)
      - [3.1.1.1 系统自带备份操作流程：](#3111-系统自带备份操作流程)
      - [3.1.1.2 系统内备份 - 数据迁出流程备忘](#3112-系统内备份---数据迁出流程备忘)
      - [3.1.1.3 备份文件损坏解决办法](#3113-备份文件损坏解决办法)
    - [3.1.2 手动备份 sdcard 目录](#312-手动备份-sdcard-目录)
    - [3.1.3 数据迁出方式备忘](#313-数据迁出方式备忘)
    - [3.1.4 把设备充满电](#314-把设备充满电)
  - [3.2 第二阶段实操：解BL锁](#32-第二阶段实操解bl锁)
  - [3.3 第三阶段实操：环境通道搭建](#33-第三阶段实操环境通道搭建)
    - [3.3.1 Android SDK Platform-Tools](#331-android-sdk-platform-tools)
    - [3.3.2 可选操作：设置 ADB 到 Windows 环境变量](#332-可选操作设置-adb-到-windows-环境变量)
    - [3.3.3 可选操作：下载安装有口皆碑的第三方集成工具](#333-可选操作下载安装有口皆碑的第三方集成工具)
  - [3.4 第四阶段实操：刷入](#34-第四阶段实操刷入)
    - [3.4.1 线刷第三方Recovery（TWRP） + 顺便获取 ROOT 权限](#341-线刷第三方recoverytwrp--顺便获取-root-权限)
      - [3.4.1.1 安装 TWRP Recovery 步骤](#3411-安装-twrp-recovery-步骤)
      - [3.4.1.2 小米 12 Pro 刷入 TWRP 备忘 + 疑难杂症记录](#3412-小米-12-pro-刷入-twrp-备忘--疑难杂症记录)
    - [3.4.2 卡刷系统](#342-卡刷系统)
      - [3.4.2.1 卡刷包下载](#3421-卡刷包下载)
      - [3.4.2.2 TWRP 卡刷步骤](#3422-twrp-卡刷步骤)
    - [3.4.3 线刷系统](#343-线刷系统)
      - [3.4.3.1 线刷包与相关工具下载](#3431-线刷包与相关工具下载)
      - [3.4.3.2 线刷包步骤](#3432-线刷包步骤)
      - [3.4.3.3 线刷疑难杂症](#3433-线刷疑难杂症)
    - [3.4.4 手动提取刷机包 BOOT + 获取 ROOT 权限](#344-手动提取刷机包-boot--获取-root-权限)
      - [3.4.4.1 提取 BOOT](#3441-提取-boot)
      - [3.4.4.2 修补 BOOT + 手动获取 ROOT 权限](#3442-修补-boot--手动获取-root-权限)
    - [3.4.5 高通9008](#345-高通9008)
  - [3.5 第五阶段：防砖与急救](#35-第五阶段防砖与急救)
    - [3.5.1. 救砖工作量评估](#351-救砖工作量评估)
    - [3.5.2. 高危操作挽救手段 —— **对症下药的针对性治疗**](#352-高危操作挽救手段--对症下药的针对性治疗)
      - [3.5.2.1 安装“防砖模块”](#3521-安装防砖模块)
      - [3.5.2.2 掌握 ADB 救急指令](#3522-掌握-adb-救急指令)
      - [3.5.2.3 安全模式大法](#3523-安全模式大法)
      - [3.5.2.4 TWRP救“冻结”变砖](#3524-twrp救冻结变砖)
  - [3.6 第六阶段：终局备份](#36-第六阶段终局备份)
    - [3.6.1 小米 12 Pro TWRP 备份步骤](#361-小米-12-pro-twrp-备份步骤)
    - [3.6.2 TWRP 备份后的数据转移（个人备忘）](#362-twrp-备份后的数据转移个人备忘)
    - [3.6.3 TWRP 备份boot/system分区说明](#363-twrp-备份bootsystem分区说明)
    - [3.6.4 PC端直接通过 adb 命令进行 TWRP 备份说明](#364-pc端直接通过-adb-命令进行-twrp-备份说明)
  - [3.7 第七阶段：恢复](#37-第七阶段恢复)
    - [3.7.1 TWRP 无法恢复：255错误](#371-twrp-无法恢复255错误)
    - [3.7.2 TWRP 恢复后的“锁屏密码”陷阱](#372-twrp-恢复后的锁屏密码陷阱)
- [写在最后](#写在最后)

--- 

# 第一章：安卓刷机的基本知识

不同于传统按部就班的教学式大纲，本文把“救砖”放在核心脉络，让那些可能略显掉书袋的部分尽量围绕救砖而展开。

* 因为我发现这种逆向思维的学习方式几乎是所有发烧友和爱好者的必经之路，只有深刻理解“怎么死”才能明白“怎么活”。
* 很多时候，刷机并非真的热爱，而是火烧眉毛的无奈之举，所以不得不持续的憋住那一口气（这就是为什么“晚上别刷机”可以成为一类梗）。
* 然而大多数老鸟甚至专家则很容易陷入“知识诅咒”，他们理解这点，却很容易忽略这点，他们更多的把精力放在 **传播知识本身** 和 **确认事实对错** 上，而忽略了新手时期的心理活动，这样很难让新手们也去感同身受的去体验各种历练。

## 1.1 刷机的基础门槛

虽然全文整体基调是新手向，但刷机的性质就决定了其门槛不可能被踏平，在高度牵扯到数据安全问题的领域里，太傻瓜化直接喂嘴里的内容确实不见得是好事，所以预防针还是要打的：
  
* 刷机前需要明确认知到，能为自身行为负责的只有自己。

* **本文所有内容仅供参考，操作之前要多想。**

* 本文可能会出现不少的“全网信息”，毕竟面对疑难杂症时，搜寻多种语言社区的多个平台属于基操，部分链接可能会指向GitHub、Reddit、Youtube等大平台，也可能会指向各种中小型垂直社区或论坛网站，读者需要自行解决语言翻译问题、账号注册问题和可能潜在的网络连接问题；
  * 如果你难以解决，甚至对相关问题完全没有概念，说明你严重缺乏高质量的信息获取能力，本身也不适合刷机这种风险性高的操作，还不到时候，请先去夯实基础。
* 对于新人，下面这点需要特别强调，你需要坦诚的问自己：
  * “我是否真总是想要 **解决问题**？” 
* 亦或只是：
  * “**靠各种外力** 不停地规避和远离问题？”
* 无论这个问题的答案是什么，只要对此你心里有数，则至少说明你明白自己在做什么，而如果你没想过，请牢记“走捷径迟早是要踩坑的”，而 **刷机** 就属于不得不大量接触“捷径”的行为，这点后文会有更细致的说明。

因为篇幅问题，哪怕是作者本人也不可能从头到尾滚瓜烂熟，遇到问题时为了便于随时查阅，请善用 `Ctrl+F` 搜索关键词进行文章定位。

--- 

## 1.2 什么是刷机？

对于真需要本文的读者来说，什么是刷机这点不必啰嗦，一句话足以：

* 刷机本质是 **替换** 设备系统的过程，**刷机不是升级，而是一次对设备系统的“破坏性重建”。**

需要真正强调的是，成功进入系统乃至获取到了ROOT权限，仅仅是个开始，只有和刷机相关的所有后续操作被验证有后悔药的时候，整个刷机过程才叫结束。

* 对于不熟悉刷机流程、因果关系和操作逻辑的新手来说，因为刷机本身就足够累了，很容易在刚刚刷机完毕后提前开香槟，进而放松警惕，开始整各种烂活，一不留神就会演变成 **变砖** 的处境。

--- 

## 1.3 什么是“砖”？

**砖(Brick)** 是电子设备无法正常工作的俗称，作为动词时，中文称 **变砖**。

这并非是中文语境下的原生词，而是一个地地道道的舶来词，普遍来自于20世纪80年代到90年代初的计算机硬件和嵌入式系统开发圈子。

这个概念的最初定型不做深究，但大面积普及则基本可以确定来自于家用游戏主机、掌机圈，毕竟相比于 PC，这是全球尺度下最早大规模进入主流消费领域的 IT 硬件，随后则因智能手机的普及，苹果、安卓生态自然而然的引入、继承了“砖”的概念。

本文作者在查资料的时候，发现维基百科的 [“Brick (electronics)”](https://en.wikipedia.org/wiki/Brick_%28electronics%29) 词条最早可以追朔的历史版本是2007年，其中首次提及了掌机“第六世代”于全球爆火的时期，也就是 **索尼PSP** 和 **任天堂NDS** 如日中天的阶段。

> 更巧的是，作者回想到自己的儿时记忆，自己的爱好软硬件的启蒙之路，还真就是从初中时期通过折腾自己第一台 PSP 的破解和刷机经历逐渐开启的，哎呀我说命运呐......

总之，**所有的刷机知识，都藏在不同程度的“变砖”症状里。**

* **软砖**：设备还有“呼吸”，能亮屏，能进某些模式，只是进不去系统。
  * 对应知识点：Recovery 分区、Boot 分区、System 分区。

* **硬砖/黑砖**：设备彻底“休克”，黑屏无反应，按键无效，指示灯不亮。
  * 对应知识点：底层引导 (Bootloader)、高通9008模式/MTK深刷模式。

--- 

## 1.4 为什么要刷机？

### 1.4.1 获取 Root 权限

* 想象一下，你买了一套房（手机），但自己手里的却是备用钥匙，开发商（手机品牌商）却拿着“主钥匙”，你还被规定不能换大门的锁。
* 这还没完，你不能砸墙装修，你甚至不能修改房间的布局，你被规定只能在客厅活动，更过分的是，他们可以随时进来检查你家里放了什么东西，然后随他们的心情任意拿走东西，或任意塞给你东西。
* 离谱么？欢迎来到安卓设备的现状。
* 刷机就是拿回这把“主钥匙”，确立你对这台设备的“主权”。  

**相关知识点：**

* **BL 锁（Bootloader Lock）：** 
  * 这是厂商的第一道枷锁，在2026年，能够开放解BL锁的安卓手机厂商已寥寥无几，很多厂商已经彻底关闭了官方解锁通道，还有一些品牌，从创立之初就从来没开放过 Bootloader 解锁通道。
  * 这一条后文会详述，见：[2.2 第二阶段：解BL锁 —— **获得“手术资格”**](#22-第二阶段解bl锁--获得手术资格)

* **防回滚机制（Anti-Rollback）：** 
  * 如果厂商推送了一个充满Bug、耗电严重或许就是单纯你不满意的新系统，你想刷回旧版本？不行。
  * 所有软件商都希望用户只能升级不能降级，品牌商对于系统层面的限制肯定更是如此。

**刷机能改变什么：**

* **最高权限（Root）：** 
  * 获得 Linux 内核级的管理员权限。  

* **修改一切：** 
  * 从修改开机动画、字体粗细，到替换系统核心组件。  

* **数据主权：** 
  * 只有获取 Root 权限后，你才能完整备份应用的所有数据。

### 1.4.2 彻底卸载预装

* 刚买的新手机，里面往往塞满了厂商的“全家桶”：电子书、钱包、以及大量的第三方软件，你哪怕不用也删不掉，常规手段下很多流氓 APP 甚至无法关闭，它们像牛皮癣一样占着你的内存，甚至在后台偷偷跑流量。

**相关知识点：**

* **商业预装回扣：** 
  * 厂商每预装一个第三方 App，都能从软件商那里拿到“人头费”。对于市场占有率足够的各个大厂而言，这是一个天文数字，为了这笔巨额利润，他们会把这些 App 写死在系统里。
    * 该问题近几年因为监管力度的加大，甚至还有所收敛，最初由运营商主导移动通信市场的时期，相当多的“合约机”，其预装APP离谱到直接拖垮系统的程度，很多手机到手后，第一件事必须是刷第三方系统，不然压根没办法使用。
      * 小米的 MIUI 系统就是在这一大背景之下崛起的。

* **不可卸载的系统服务：** 
  * 除了明面上的 App，还有大量看不见的后台服务（如“用户体验计划”、“系统广告服务”、“快应用中心”）。这些东西常驻后台，占用内存，只为了给厂商推送广告或收集数据。  

* **复活机制：** 
  * 常规手段的卸载，不过是一种安抚性质的过家家，毒瘤 App 之所以是毒瘤，就是因为它的权限比你更大，自然能永远留在你的设备上。

**刷机能改变什么：**

* **斩草除根：** 
  * 通过 Root 权限，可以删除任何文件。  

* **空间释放：** 
  * 真正腾出被垃圾软件占用的存储空间和运存资源。

### 1.4.3 摆脱厂商云控劣化/老机续命

* 非常多的旧安卓设备，硬件其实没坏，但厂商为了卖新机，不再给旧机推送正常的优化更新，甚至更新内容会反向劣化，迫使旧系统越来越卡。

* 正因如此，这是这是目前多数刷机玩家的主要动力。

* 此时“刷机”就是法律层面上的主动维权行为。

**相关知识点：**

* **负优化/劣化更新：** 
  * 著名的“苹果降频门”和三星类似事件在欧盟被判处巨额罚款；通过软件更新降低旧设备性能，而不明确告知用户，在法律上明确构成 **欺诈**。
  * 然而，这种事可能只发生在苹果用户身上么？甚至可以说正是拜苹果所赐，安卓厂商们发现自己这么做的隐蔽性比苹果高得多，且完全没什么代价时，数年来屡次在旧机型的更新中，以“保护电池”或“系统稳定”为借口（近几年甚至连借口都懒得提），极度保守地调度硬件性能释放，让手机变得卡顿，让你产生“手机老了，该换了”的错觉。  

* **计划性报废：** 
  * 任何厂商都巴不得消费者年年换新机，但是现代消费电子领域的产品寿命其实非常坚挺，尤其是旗舰手机，其核心 SOC 出厂的性能指标，对于绝大多数普通用户来说，**远超其真实需求的十倍甚至百倍** 。
  * 于是厂商暗地劣化旧机性能从而推行新机销量，这已经成了一种普遍的行业通行操作，甚至如今成功塑造了绝大多数普通消费者的思维共识，那就是 **“手机卡了，就该换新的”**，全球每年因此而产生的电子垃圾浩如烟海。
    * 扩展资料：维基百科 [太阳神垄断联盟](https://zh.wikipedia.org/wiki/%E5%A4%AA%E9%98%B3%E7%A5%9E%E5%9E%84%E6%96%AD%E8%81%94%E7%9B%9F) 词条。
      * 该组织成立于 **1924** 年，**在没有任何芯片控制甚至没有集成电路的 100 年前，这些巨头就可以通过提前规划工艺和元器件材料的寿命，从而在全球层面实现全行业规模的计划性报废**。
      * 在 100 年后的今天，计划性报废对于任何一家商业巨头来说，自然是信手拈来，甚至成为了商业准则级别的 **“普世价值”** 。
  * 厂商自己“发力”的同时，与各大主流安卓软件开发商巨头或明或暗的“合谋”已经持续了数十年：
    * 很多 App 动不动就提醒更新，甚至提示系统版本太低“无法安装”需先升级系统。
    * 这种时候很多人会想起诞生于 PC 领域的 安迪-比尔定律：
      * 扩展资料：维基百科 [安迪-比尔定律](https://zh.wikipedia.org/wiki/%E5%AE%89%E8%BF%AA-%E6%AF%94%E7%88%BE%E5%AE%9A%E5%BE%8B) 。
      * 其本质是在比喻一种 **“良性追赶”**，当体验和性能同步提升的时候，正是互相赋予价值的时候。
    * 但目前在消费级移动设备生态下，至少在简中环境里，其硬件性能和存储占用问题显然和安迪-比尔定律不是一回事，而是早就处于一种病态般扭曲的现状。
      * 软件的挥霍，终归是“应该”有上限的，虽然各个互联网大厂旗下的软件都存在主观挥霍硬件性能的动力，但总不能过分到明目张胆站着茅坑不拉 Shit 的程度吧？
      * 可惜现实中更过分，如今某些“互联网基建”级别的垄断巨头，始终在不停的“突破”这种上限，某些 “超级 APP ”，在做到了对用户没有任何实际使用体验提升的同时，却依旧达到了“鸠占鹊巢”级别的臃肿，**完全可以说是在凭空吃掉硬件的性能**，单纯从开发者角度来看，这绝对是匪夷所思的程度。
      * 然而，这种“房间里的大象”却在被普遍轻视，甚至被无视，目前全网范围内你能看到对此最激烈的声音，仅仅是大伙嘲讽其明明都是垄断地位的大厂，却一点小事儿也干不好，然而，事实真就这么的简单和儿戏吗？
      * 当一个低级错误只影响少数人的时候不值一提，但其能够影响到十几亿人，甚至数十亿人的时候，就不再是低级错误，甚至不再是错误。

* **安全停更：** 
  * 停止安全补丁推送，停止系统的日常维护更新，美名其曰“旧设备不支持”，而本质上就是想不想的事罢了。

* **跑分作弊、性能释放虚假宣传：** 
  * 厂商会在系统里内置一份名单。检测到你在运行“安兔兔”、“Geekbench”时， CPU、GPU 满血奔跑，跑分极高；
  * 而你日常使用时遇到真正的高负载需求时，系统则会通过强制降频等方式限制性能。 

* **动态云控：** 
  * 最可怕的问题在于，这种控制逐渐向动态的、云端的方式发展，厂商不需要更新系统，只需要在其官方服务器改个参数，便可以任意调整消费者手机中的核心设置和调度功能，这是对用户硬件所有权的公然侵犯。

**刷机能改变什么：**

* **第三方维护：** 
  * 即使厂商抛弃了你，社区开发者会为你的旧手机适配最新的 Android 系统，让它焕发新生，全球开发者社区（如 XDA）甚至会为 5 到 10 年前的经典机型适配最新的 Android 14/15。  

* **移除温控与云控：** 
  * Root 后，你可以直接删除系统里的温控配置文件，或者冻结/删除云控组件，切断厂商在性能调度层面伸向设备的那只手。 
    * 操作不当也可能有损坏硬件的风险。
 
* **满血释放：** 
  * 去掉了云控限制，设备芯片才能发挥出它设计指标上的完整性能，发热还是卡顿由自己权衡而不是厂商替你做主。
    * 操作不当也可能有损坏硬件的风险。

* **老机新生：** 
  * 去除厂商沉重的包袱，跑在更纯净系统之下，旧手机才可能真的优化到新机一样流畅。

### 1.4.4 极限优化性能 & 续航

* 厂商出厂的系统设置通常是“中庸”甚至“过度保守”的，安卓设备厂商为了防止用户因为手机高负载发热而导致的售后维修成本，甚至哪怕只是为了减少投诉，厂商都会选择让 100% 的用户都体验降频。
  * 就像一辆跑车，本身有开到 300 码的能力，但出厂时被电子限速锁死在了 120 码。
* 厂商在发布会上宣传的性能（跑分、刷新率、充电功率），往往只能在极其苛刻的实验室条件或特定的“跑分软件”中实现。在日常使用中通过软件限制锁死性能，导致用户实际体验与宣传严重不符，这种针对特定场景的“区别对待”，本质上就是基于双重标准的欺诈，这直接意味着涉嫌参数造假，最次也是虚假宣传。

**相关知识点：**

* **屏幕刷新率锁：** 
  * 比如你买的是 120Hz 屏幕，但厂商为了省电数据好看，会在短视频 App、地图 App 里强制锁死 60Hz，导致割裂感极强。你想全局 120Hz？官方设置里通常不给你这个选项。  

* **充电速度限制：** 
  * 宣传 120W 快充，但只要亮屏使用，充电功率瞬间砍到 20W。

* **杀后台（激进的内存管理）：** 
  * 为了掩盖系统优化差导致的耗电，也可能是放任软件大厂流氓化所导致的反噬，国产厂商普遍采用极其暴力的杀后台策略。
    * 举例：你在其他APP界面时，切出去回个微信，回来APP就被自动关闭了；你锁屏一会，音乐软件就被自动关闭了。

**刷机能改变什么：**

* **内核（Kernel）调校：** 
  * 刷入第三方内核，可以解锁 CPU 频率限制（超频）提示性能，代价是更高的发热和功耗
    * 操作不当可能加速核心硬件老化、缩短使用寿命、甚至直接损害硬件。
  * 或者通过降压超频（Undervolt）在保持最低可用性能的同时降低功耗和发热量，从而大幅省电提高续航能力。  

* **墓碑机制：** 
  * Root 后可以使用类似 iOS 的“墓碑”软件（如“暂停执行”），让后台应用真正冻结而非被杀掉，兼顾流畅与多APP留存。

### 1.4.5 玩第三方系统

* 时至今日，各家官方系统逐渐变成了卖广告位的“商场”，最讽刺的是，包括这个商场在内的整块地皮都是你自己花真金白银买的，而这个商场里的所有广告商和你没有半毛钱关系。
  * 区别无非是一些品牌曾经“立过牌坊”，还有一些是诞生之初就从未干净过。
* 刷机就是把这个商场拆了，建一个只属于你的工作室。

**相关知识点：**

* **OS 广告化：** 
  * 天气、日历、文件管理器、应用安装界面……厂商在所有自带的高频应用里都植入了开屏广告或信息流广告。
  * 对于真正在乎的人来说，这不仅恶心，还消耗你的流量和电量。  

* **隐私黑箱：** 
  * 原厂系统会上传你的应用列表、位置信息、甚至相册元数据到云端，用于训练他们的 AI 或进行用户画像，消费者很难完全关闭这些数据收集。 
  * 原厂系统植入了太多的“合法后门”，这种系统级的监控想要依靠手动操作逐个剔除还不残留，无异于屎上雕花。

* **隐私货币化：** 
  * 厂商在未获得用户充分知情同意（通常隐藏在几万字的用户协议里，同时附加霸王条款，不同意你就别用）的情况下，收集用户行为数据并用于商业变现（如精准推送广告）。
  * 核心隐私就像核武器，精准推送广告不过是拉出去展览赚点小钱，真正被“用到”的时候则只有毁天灭地，不会留下一丝余地，而如今，整个互联网行业早已事实上将用户的 **隐私权** 当成了商品，有些人觉得自己隐私并不值钱，丢了就丢了，对这种人来说，他们身上的一切其实都并不值钱，因为但凡有值钱的东西，其实质也早就不属于他们自己。

* **审美霸凌：** 
  * 原厂系统在主题、风格、状态栏等细节布局上皆有诸多限制，仅提供极为有限的修改方式，如官方预设、购买付费主题等。

**刷机能改变什么：**

* **开源与透明：** 
  * 第三方系统代码开源，而类原生系统可体验谷歌 Pixel 手机那样极其简洁、轻快、没有任何广告的系统。
  * 如 LineageOS, Pixel Experience, crDroid。
 
* **功能互补：** 
  * 第三方系统通常提供官方系统不具备的数百项自定义功能，且代码开源，更加透明安全，更加容易做到没有后门，彻底切断厂商的数据吸管。

### 1.4.6 建立自救能力

* 刷机有一个始终绕不开的终极理由，也是本文后续内容的核心重点：**救砖！**

**相关知识点：**

* **维修权剥夺：**
  * 厂商限制用户刷机，实质上剥夺了用户对已购财产的维修权。
  * 这使得用户在面对简单的软件故障时，可能被迫接受高额维修报价（掠夺性定价）。

* **技术勒索：**
  * 对于系统崩溃（软损坏），维修时往往会告诉你“硬件坏了，得换XX硬件”，原本不花钱就能解决的问题，有可能就得开始花钱了。

* **售后溢价：**
  * 原本靠精细维修部分硬件 + 软件优化可解决的问题，却强制要求用户付费更换整个硬件模块，比如动不动就换整块主板，这种利用信息差和技术壁垒来压榨消费者的行为，在道德上属于典型的技术勒索，原本花小钱能解决的问题，就有可能花大钱了。

**刷机能改变什么：**

* 建立自救能力： 
  * 只要硬件没有问题，就永远拥有把手机“起死回生”的能力。
  * 掌握刷机技术，本质上就是掌握了修复设备软件故障的 **终极手段** 。

--- 

## 1.5 安卓分区/系统架构概念

这一部分如果完全展开会很长，无论放在前期还是后期，一次性写完都会很容易让读者摸不着头脑，所以为了可读性，我将其拆分成了非常多的小段，在这里只做一个最基本的概念性梳理，之后在需要的地方再逐渐展开。

安卓设备包含若干个分区，这些分区在启动过程中发挥不同的作用。

日常使用的“系统”（比如小米的 MIUI、谷歌的Pixel UI）仅工作在其中一个分区（System），而刷机，就必须对各种分区尤其是核心分区进行足够清晰的了解。

### 1.5.1. 引导相关核心分区介绍

贪多嚼不烂，这里仅介绍几个对于刷机来说至关重要的分区，更多的分区如和备份高度相关的分区，后文会慢慢展开，到时候会特意提及。

#### 1.5.1.1 Bootloader（引导加载程序）
* **类比**：类似于电脑的 BIOS。  

* **作用**：初始化硬件，验证完整性，引导 Boot 开始工作，决定启动 Recovery 还是 System。

* 所谓的 **“OEM解锁”、“解锁Bootloader”、“解BL锁”**，指的就是解开这个阶段功能，即**能动的了 Bootloader，才能做后面的事！** 

* **故障表现**：若此分区损坏，设备将彻底黑屏（硬砖）。 

#### 1.5.1.2 Boot（内核）

* **类比**：类似大脑的“脑干”，是操作系统启动的“点火装置”或“登机口”。

* **作用**：包含 Kernel (内核) 和 Ramdisk，对外直接沟通操作系统，对内决定硬件如何工作，Boot（内核）存储并提供操作系统启动阶段所需的所有关键文件，在 Bootloader 阶段运行后，它会去寻找这些文件来把操作系统“搬运”到内存里运行。

* **Root权限**：通常就是通过修补 Boot 分区镜像来获取Root权限（使用Magisk 等工具）。  

* **故障表现**：若此分区损坏，设备卡第一屏安卓logo。 

#### 1.5.1.3 System（系统）
* **类比**：相当于 Windows 电脑的 C:\\Windows 目录。  

* **作用**：存放 Android 操作系统文件、UI 界面、系统预装 App。  

* **故障表现**：若此分区损坏，设备卡第二屏品牌LOGO。

#### 1.5.1.4 Recovery（恢复）
* **类比**：类似于 Windows 电脑的 PE系统。  

* **作用**：一个微型的独立操作系统，专门用于清除数据、安装更新包，设备出厂的默认Recovery通常功能非常有限，刷机时强烈推荐刷入第三方 Recovery（例如TWRP，见后文）。

#### 1.5.1.5 Vendor（供应商）
* **作用**：存放厂商定制的硬件驱动程序（SoC、相机、传感器驱动）。

以上只是老安卓设备相对重要的部分分区系统，视不同的设备和厂商定制等因素影响，实际上的分区会更多。

一个需要严肃强调的信息是，**有些分区为基带、字库、蓝牙、传感器等更底层的硬件信息分区，备份起来较为复杂，甚至操作不当可能无法彻底备份，新手不懂不要乱动**，具体细节后文会展开。

### 1.5.2. 分区机制的断代史：教科书般的屎山代码

刷机最大的坑，往往来自于用旧时代的经验去刷现代架构的设备。

安卓系统在经历了数十年的大版本更新后，已经发生了巨大的改变，不同的架构导致分区机制产生了巨大的区别。

这些变化和刷机过程中需要关注的分区高度相关。

所以需要单独列出来，进行区分，在刷机之前，一定要明确自身设备的安卓大版本号。

**注：“架构差异”是刷机中的核心知识点，本文全文会多次以多个角度进行诠释，请严肃对待。**

#### 1.5.2.1 【传统分区】(Non-A/B / Only A) —— *Android 7.0 之前*

* **结构**：拥有独立的 Recovery 分区，独立的 Cache 分区。  
* **特点**：结构简单直观。  

#### 1.5.2.2 【A/B 分区】(Seamless Updates) —— *Android 7.0 \~ 9.0*

* **背景**：为了实现“无缝更新”，设备里有两套系统分区（Slot A 和 Slot B）。  

* **结构巨变**：  
  * **取消了独立的 Recovery 分区**：Recovery 被整合进了 Boot 分区中。  
  * **取消了 Cache 分区**。  

* **刷机难点**：  
  * 无法直接刷入 Recovery。  
  * 必须先 fastboot boot twrp.img 临时启动，再在 TWRP 里“修补”Boot 分区以固定 REC。  
  * **救砖优势**：如果 A 分区升级失败，可以切换到 B 分区启动，大大降低变砖概率。

#### 1.5.2.3 【动态分区】(Dynamic Partitions / VAB) —— *Android 10+ (主流现状)*

* **背景**：为了灵活分配存储空间，解决了 System 分区空间不足的问题。  

* **结构巨变**：  
  * 引入 **Super 分区**：一个巨大的物理分区，内部包含 System, Vendor, Product 等逻辑分区，大小可动态调整。  
  * **Virtual A/B (VAB)**：结合了 A/B 的无缝更新和动态分区的灵活性。  

* **刷机难点**：  
  * **System 分区变为只读**：难以直接删除系统文件。  
  * **FastbootD 模式**：传统的 Fastboot 无法操作动态分区内的逻辑分区，必须进入用户空间的 FastbootD 模式才能刷入 System 镜像。

更多细节详见：
> 关于安卓系统的分区信息，详见个人反复查阅几十遍的启蒙圣经：B站极客湾视频： [「玩机必看！带你入坑安卓刷机，小白也能看懂的ROOT基础指南来啦！」](https://www.bilibili.com/video/BV1BY4y1H7Mc?t=1168)，强烈推荐。
>
> Android开源项目官网文档：[「-分区-概览」](
https://source.android.com/docs/core/architecture/partitions?hl=zh-cn)，强烈推荐。
> 
> B站UP主FlashCorpa系列视频之一：[「什么是ab什么是vab，安卓架构是什么」](https://www.bilibili.com/video/BV1AM4y1U7uq)，比较推荐。
> 
>知乎文章：[「Android系统分区与升级」](https://zhuanlan.zhihu.com/p/364003927)，比较推荐。

### 1.5.3. 小结：变砖的简易诊断

* **卡 Logo / 无限重启**：通常是 Boot 校验失败或 System 文件损坏。 
 
* **进不去 System 但能进 Fastboot**：Bootloader 完好，只需重刷 Boot 或 Recovery。  

* **彻底黑屏**：Bootloader 损坏，需调用 CPU 级别的紧急下载模式（9008/MTK深刷模式）。

--- 

# 第二章：刷机的完整逻辑

**注：本章的重点是必要的核心概念知识梳理，新手千万别当算盘珠子，你至少应该把本章完整的读完，梳理清自己的思路，然后再开始参照第三章尝试刷机。**

第一章的目标是入门级别的科普，如果你没有那么的新手，那第一章可能对你来说可能没太多内容；

但第二章经历了至少5次以上的重写，是花大力气部分，非常的通用，也是本文的重点。

文章的写作目的是“知其所以然”，主要侧重在 **“为什么”** 而不是 **“怎么做”** 。

**刷机的完整逻辑 = 一次可控的“救砖”演习。**

正常的刷机流程，其实就是主动把系统破坏（格式化），然后再修复（刷入）的过程。

而这一大章节，将刷机比喻为一场 **人体器官移植手术** ，希望这样可以尽可能直观的展示刷机过程中各个知识点的地位和相对应关系。

本章将会分为七个阶段，具体内容如下：

* [2.1 第一阶段：备份+充满电 —— **制作“克隆体”，然后吃饱饭**](#21-第一阶段备份充满电--制作克隆体然后吃饱饭)
* [2.2 第二阶段：解BL锁 —— **获得“手术资格”**](#22-第二阶段解bl锁--获得手术资格)
* [2.3 第三阶段：环境通道搭建 —— **“术前准备”**](#23-第三阶段环境通道搭建--术前准备)
* [2.4 第四阶段：刷入 —— **植入新的“器官”（甚至可以是旧的）**](#24-第四阶段刷入--植入新的器官甚至可以是旧的)
* [2.5 第五阶段：防砖与急救 —— **亡羊补牢的“术后保险”**](#25-第五阶段防砖与急救--亡羊补牢的术后保险)
* [2.6 第六阶段：终局备份 —— **制作更强的克隆体**](#26-第六阶段终局备份--制作更强的克隆体)
* [2.7 第七阶段：恢复 —— **复活！**](#27-第七阶段恢复--复活)


## 2.1 第一阶段：备份+充满电 —— **制作“克隆体”，然后吃饱饭**

**先备份的直接原因：**

* 解锁 Bootloader = 强制恢复出厂设置，还没开始刷机，你的照片、微信记录等就会先被清空，所以需要先行备份。

人死了就是死了，但机器好就好在这令碳基生物羡慕的备份机制，只能说血肉苦弱，希望人类尽快实现机械飞升......

本阶段拿来比喻的话，“克隆”应该比较接近，就像《Rick and morty》中Rick的凤凰计划，无限重生的前提，是准备做的足够充分。

### 2.1.1 系统内备份
首先用安卓设备厂商第一方系统内自带的“备份与恢复”或“电脑助手”等手段进行备份，这样至少能保住的照片、联系人、短信和部分APP内数据。
* 虽然这种备份方式不彻底，但是需要特备强调，以便从一开始就端正心态。

* 要做好这些备份可能恢复不回去的心理准备（跨系统不兼容、APP版本不兼容、单纯BUG导致的恢复失败），

### 2.1.2 手动备份 sdcard 目录
将设备 `/sdcard` 目录下的所有文件夹完整拷贝到电脑硬盘，其中包括你手动导入设备的文件。

* 通过USB线有线连接并在安卓设备端选择 **“文件传输”** 后能够被识别到的目录即为 `/sdcard` 目录。

* 通常备份方式是通过有线连接传输，但鉴于大量安卓设备尤其是前些年的旗舰手机都在使用 `USB 2.0` 的龟速协议，另一个比较推荐的办法是安卓设备和电脑处于同一局域网内，使用FTP协议直接无线传输。

* 有大量流氓APP非常喜欢在 `/sdcard` 目录下造垃圾，所以强烈建议去了解一下该目录下的文件夹命名逻辑和分类，然后经过整理之后针对性的备份，具体细节见后文的这一节：[2.6.1.5. 内部存储设备（sdcard分区/公共存储空间/真·外部存储）](#2615-内部存储设备sdcard分区公共存储空间真外部存储)。

因为所有由用户手动传输进设备的文件都在 `/sdcard` 目录，所以 **手动备份** 这一步始终是不可或缺的。

以及，你后面会需要多次备份这个目录，这只是第一次而已，本阶段与本章：[2.6 第六阶段：终局备份 —— **制作更强的克隆体**](#27-第六阶段终局备份--制作更强的克隆体) 高度相关，所以这一部分可以仅做初步认识，进一步的深入了解可到第六阶段再进行。

### 2.1.3 把设备充满电
有太多教程压根没有提到这一点，可能是因为这点过于常识...

刷机过程中断电，大概率导致真·硬砖，虽然大部分人都知道电量就是生命线，但新手特别容易把这事忽略，所以这里需要单独强调。

*以上，第二章 第一阶段（备份+充满电）结束。*

--- 

## 2.2 第二阶段：解BL锁 —— **获得“手术资格”**

### 2.2.1 确认设备能够解 BL 锁

绝大多数安卓设备和几乎所有安卓手机，只要 Bootloader 锁着，你便无法修改分区，你甚至无法看到分区，再后面的事情就更无从谈起，比如获取ROOT权限就需要修改BOOT分区（曾经的魅族除外，现在未知），所以：
* 解锁 Bootloader 是第一道必须要过的坎。 
  * 然而对于简中环境，仅仅是这第一道坎，就成为了一道天堑，将绝大多数的安卓设备拒之门外。
  * 能够开放解BL锁的安卓手机厂商，本就寥寥无几，而在2026年，有这么一个厂商，作为国内最早 **甚至是唯一一家官方鼓励用户** 解锁 Bootloader 、提供完整刷机教程和官方论坛支持的第三方安卓系统开发商，作为使 **“刷机”** 一词在中文互联网彻底从小众极客圈走向大众的商业化典范，作为第一个以 **“刷机”** 作为核心卖点并成功推向主流市场的手机制造商，刷机界的“集大成者”：小米，也背叛了发烧友群体。
    * 或许整体来看，存在宏观市场导向或者更大外部压力等客观现实原因，但如今事实是清晰的：屠龙的少年终究成了恶龙。
    * 只能说这是如今简中互联网刷机圈极大萎缩的重要原因之一。
    * 具体是非曲直的细节不过多赘述，如有兴趣请自行吃瓜研究。

* 但是，路再难走，总归还是有的，这里推荐Github的一篇文档：
  * [「各 Android 手机厂商 Bootloader 解锁 / 内核开源 / 解锁后保修情况」](https://github.com/KHwang9883/MobileModels/blob/master/misc/bootloader-kernel-source.md)
    * 该文档作者在其个人网站也有备份：[「各 Android 手机厂商 Bootloader 解锁 / 内核开源 / 解锁后保修情况」](https://khwang9883.github.io/MobileModels/misc/bootloader-kernel-source.html)
    * 截止本文撰写时，该文档更新至 2025年8月25日，如果你在其中查到自身设备品牌解锁现状，发现解锁任然有望，并且最终成功解锁了设备，那就可以考虑刷机了。
    * 顺便一提，该文档属于另一个项目[「手机品牌型号汇总」](https://github.com/KHwang9883/MobileModels/tree/master)的子文档，其项目始于2014年,更新至今，非常详细的列举了大大小小各手机品牌的型号。

### 2.2.2 解开 BL 锁 (Unlock Bootloader)
* 对于具体的解锁方式，各品牌的各型号甚至各版本的解锁方式和厂商政策都有所不同，所以请自行寻找操作方案，这部分本文略过。

* 可参考个人反复查阅几十遍的启蒙圣经：B站极客湾视频： [「玩机必看！带你入坑安卓刷机，小白也能看懂的ROOT基础指南来啦！」](https://www.bilibili.com/video/BV1BY4y1H7Mc?t=1168)，该视频中品牌解锁部分可能已过时，请自行甄别。

* 二手平台的第三方“帮解锁”有很大风险，对方可能通过非法途径解锁，可能会导致手机被盗、可能个人信息泄露，甚至可能收到“解锁后”仍被锁定的手机，请自行评估。

扩展参考资料：
> Reddit 论坛帖子：[「2025年哪些手机最适合刷机、装定制ROM和Linux系统」](https://www.reddit.com/r/Android/comments/1ikpdnm/lets_make_a_list_of_best_phones_for_rooting/?tl=zh-hans)
>
> B站 2025年11月28日视频：[粗粮老机解锁BL可能彻底关闭！还能解的要尽快了！](https://www.bilibili.com/video/BV1yMSJBpESH/)

*以上，第二章 第二阶段（解BL锁）结束。*

## 2.3 第三阶段：环境通道搭建 —— **“术前准备”**
这一部分是新手刷机准备工作中容易被忽视，但技术含量很高的基础环节，尤其是 ADB 和 Fastboot，它们不仅是刷机工具，更是理解安卓系统如何与外部设备通信的钥匙。

很多新手刷机失败（或救砖无门），根本原因就是，当找到解决方案之后才后知后觉的意识到，自己当初根本没做好准备。

电脑是刷机过程中必备的一部分，所以电脑端的环境配置和准备工作必不可少，所以这第三阶段，就像一场重大器官移植手术之前的准备阶段，家属、患者、医生、器械全都有事可做，全都有事必须要做。

以下部分是必须要熟悉的，可以不精通，但真遇上事了，至少可以很快上手使用。

### 2.3.1 Android SDK Platform-Tools —— **绝对权威“急诊中心”**

* **定义**：Android SDK Platform-Tools 是一整套包含 `adb.exe` , `fastboot.exe` 以及相关依赖库在内的工具集。 

* **地位**：这是 Google 官方提供的、最纯净、最核心的调试工具包。  
  * Android SDK Platform-Tools 属于“安卓软件生态系统的软件开发工具包”(Android SDK) 的其中一个组件，刷机仅需要下载独立的该组件命令行工具：
    * Android官网的下载链接：[《SDK 平台工具版本说明》](https://developer.android.com/tools/releases/platform-tools?hl=zh-cn)

* **原则**：使用 Google 官方原版工具行命令行操作，这才是最可控的。
  * **一定要拒绝来历不明的第三方集成工具软件**。
  * 几乎所有第三方工具，其底层依旧是Android SDK Platform-Tools，无非是在其之上做了图形化界面，或者集成了一些一键脚本，它们往往版本过时，甚至夹带私货，不过有口皆碑的软件还是可以用的，这里推荐 **“搞机工具箱”** 、**柚坛工具箱**（切记去下载官方版本）。
    * **搞机工具箱**：酷安大佬 & B站UP主“晨钟酱”开发，官网：[晨钟网络科技](https://jamcz.com/)
    * **柚坛工具箱**：[柚坛论坛](https://www.uotan.cn/) 所开发的工具箱，官网：[Uotan Toolbox](https://toolbox.uotan.cn/)，柚坛工具箱Github仓库：[柚坛工具箱 NT](https://github.com/Uotan-Dev/UotanToolboxNT)
  * 切记，工具只是辅助，就算使用这些集成的“工具箱”，依然需要对为什么使用这些工具的前因后果具备够清晰的认知，尤其是各种基本的 ADB 命令代码，非常有学习的必要。
    * 毕竟再贵的螺丝刀，核心功能也只是拿来拧螺丝，你不能指望工具本身替你干所有的活。 

### 2.3.2 ADB (Android Debug Bridge) —— **通用标准“手术台”**
* **定义**：连接电脑与安卓设备的命令行调试桥。  

* **工作层级**：Android 系统层 (System) 或 恢复模式 (Recovery)。  

* **核心作用**：  
  * **指令发送**：比如告诉设备“重启到 Bootloader 模式” (adb reboot bootloader)。  
  * **救急传输**：当 Data 分区无法挂载、无法拷贝文件时，通过 adb sideload 强行从电脑推送刷机包进设备进行安装。  
  * **系统调试**：即使设备触屏失灵或黑屏（但系统还在运行），也能通过 ADB 导出照片、安装/卸载应用。  

更多细节详见：
> Android 开源项目官网文档：[Android 调试桥 (adb)](https://developer.android.com/tools/adb?hl=zh-cn)
> 
> 知乎作者“木头人”文章：[ADB 命令大全](https://zhuanlan.zhihu.com/p/89060003)

### 2.3.3 驱动 (Drivers) —— **“护士、器械与技师”**
* **可能的问题**：工具下载了，安卓设备也插上了，但没反应？这可能是驱动缺失。
  
* **设备连接 & 驱动安装步骤**： 
  * **设备端**：不同品牌操作逻辑可能略有不同，但最终都是打开安卓设备的 `开发者选项` 以及 `USB调试`（部分机型还要打开特殊设置，如小米的“安全设置”，USB安装等等）， **如果弹出授权，勾选后点击允许。** 
  * **电脑端**：Win8/10/11自带ADB驱动，务必确定只有自己电脑无法识别设备后再安装驱动，否则多个ADB驱动会导致设备连接异常。

更多细节详见：
> 酷安大佬 & B站UP主“晨钟酱”的B站专栏：[「玩机必看！超详细的ADB设备连接 & 驱动安装教程」](https://www.bilibili.com/read/cv16541940/?jump_opus=1)

### 2.3.4 Fastboot —— **“体外循环系统+超精密手术机械臂” (ECMO & Surgical Robotic Arm)”**

前文已经介绍过 Bootloader，作用是初始化硬件，验证完整性，决定启动 Recovery 还是 System。

Fastboot 便是属于 Bootloader 中的一部分。

已经变砖到需要进 Fastboot 阶段的设备，确实基本与病床上那种深度昏迷，心脏停跳，完全依靠机器维持生命的病人没啥区别。

* **定义**：一种比 ADB 更底层的通信协议，直接与 Bootloader 对话。  

* **工作层级**：Bootloader 模式 (Fastboot Mode)。  

* **地位**：这是刷机和救砖的 **真正主战场**。当 Android 系统彻底崩溃（进不去系统，进不去 Recovery）时，只要能进 Fastboot，安卓设备就能救活。  

* **核心作用**：无视系统状态，直接向安卓设备的特定分区写入镜像文件。  

> 强烈推荐这篇安卓开源项目官方文档：[使用 fastboot 刷写](https://source.android.com/docs/setup/test/running?hl=zh-cn#unlocking-the-bootloader)（请注意其中“解锁引导加载程序”部分，别看走眼真觉得解BL锁那么简单，除非你的手机是Pixel）

*以上，第二章 第三阶段（环境搭建）结束。*

--- 

## 2.4 第四阶段：刷入 —— **植入新的“器官”（甚至可以是旧的）**

这部分依旧拿人体手术进行比喻，那便是标准的器官移植，大部分情况下，刷机都是刷操作系统，而刷操作系统基本等于 **换个脑子**，只是换的方式不一样。

第四阶段的所有内容会先进行精细的比喻，以便理解，然后再逐条展开：
* 刷入第三方Recovery ≈ **肉体强度 + 脊髓 + 全身神经系统的强化改造。**
  * 强化方向全是为了 **换脑** 而定向增强，比一般的肉体更耐造，便于 **换脑** 。
  * 经过强化后，就更难弄死自己了，很多传统意义上的高危操作这时候也就导致变成“植物人”。
  * 经过强化后，肚子里甚至能多长个器官专门存很多个备份脑子，只要愿意，就可以在不上手术台的情况下自己扣开脑壳把脑子给换了（越比喻越离谱，但是如此对标确实非常合适，哎呀我可真牛逼，叉会儿腰）

* 卡刷系统 ≈ **“强化人”自助“换脑”复活。**
  * 经过强化后的强化人，即便变成“植物人”（进不了系统）也能自助 **换脑**。
  * 所谓的自助就是不需要上手术台，即上面说的自己扣开脑壳**换脑**。

* ADB Sideload  ≈ **外部操控的微型手术机器人**
  * 通过 ADB Sideload 换器官就是微创+迅速的手术，虽然手术创口不大，速度也快，但能做到的事也很有限。

* 线刷系统 ≈ **将“彻底脑死亡的新鲜尸体”上超精密手术机械臂手术台“换脑”复活。**
  * 进入这一程度就必须上手术台了，而且所有操作只能由外部完成。

* 高通9008模式/MTK深刷模式 ≈ **近乎于重生的超级人造子宫。**
  * 基本等于回炉重造了，但前提是你得有“炉”可回（工具软件获取困难且基本都是厂商高度定制）。
  * 神仙级别的操作，返老还童听着美好，但不是凡人该想的事（知识门槛同样很高）。
  
下面是逐条展开，对于建立刷机理念非常重要，需要重视。

### 2.4.1 刷入第三方Recovery（TWRP） —— **神经系统的强化改造**

* **定义**：将官方简陋、功能受限的 Recovery 分区替换为功能强大的、支持触屏操作的第三方工具。

* **地位**：承上启下，它是连接“官方系统”与“第三方 ROM”的必经桥梁，没有它，你无法方便地进行“卡刷”。

  如前文简单介绍，各安卓设备自带的Recovery功能上都极为有限，而作为刷机，尤其是从救砖的角度来说，刷入第三方Recovery是非常必要的。

  在2026年，第三方Recovery几乎只剩下了TWRP可选，无非是官方版本还是第三方版本的区别罢了。

#### 2.4.1.1 TWRP是什么？

* TWRP：国外安卓爱好者团队 Team Win 开发的一个第三方REC，全名Team Win Recovery Project。

* TWRP提供了一个支持触屏的界面，能够进行安装第三方固件、备份当前系统等等官方 Recovery 一般不支持的功能。

#### 2.4.1.2 TWRP核心能力

* **绕过签名验证**：官方 Rec 只允许刷官方包，TWRP 允许刷任何 ZIP 包（包括 Root 包、第三方 ROM）。

* **整机备份**：可以像电脑 Ghost 还原一样，备份整个系统分区和data分区，是救砖的强力手段。

* **文件管理**：在手机系统崩溃（软砖）时，通过 TWRP 的文件管理器可以把重要数据拷出来。

#### 2.4.1.3 TWRP的下载渠道

TWRP是有项目官网的：

* TWRP官网链接：[TWRP.me](https://twrp.me/)
  * [点击此处](https://twrp.me/Devices/) 查看TWRP官方支持设备列表。
  * 如果设备型号已经在官方支持的设备列表，最好直接下官方版。
    * 比如我手中有台小米8,其发布页：[TWRP for Xiaomi Mi 8](https://twrp.me/xiaomi/xiaomimi8.html)
  
TWRP官方不一定支持所有安卓设备，甚至在2026年，相当多的新设备都不支持，但鉴于第三方的 Recovery 本来就没几个，所以 TWRP 已经属于该领域事实上的独苗，毕竟TWRP拥有第三方 Recovery 里的最大的生态基础，有大量的分支版本是支持新设备的，是的，也就是第三方的第三方......

时至今日，大量开发者承担了非常多手机的适配工作，他们拿官方 TWRP 的源码，结合特定设备的配置，专门适配各种具体型号进行编译并发布，大大方便了普通用户。

这其中我比较推荐的渠道是 **在 XDA 论坛中寻找**：

* 论坛链接：[XDA Forums (xdaforums.com)](https://xdaforums.com/)，
  * XDA论坛：基本可以说是全球最大的智能手机和移动设备开发者论坛，极为多的干货和大量疑难杂症解决方案都在其中，不同于某些焚书坑儒的简中社区，XDA很多上古老帖都能够直接被搜索到，这意味着对刷机党来说妥妥的救砖宝藏！

* 具体方法为搜索“手机型号+TWRP”。
  * 举例：Xiaomi 12 pro，skkk的非官方 TWRP，其XDA发布帖：[OFFICIAL TWRP by skkk](https://xdaforums.com/t/shared-official-twrp-by-skkk.4467233/) 。

#### 2.4.1.4 向设备内安装TWRP

基本刷入步骤简述如下：

1. 保证安卓设备与电脑间的 adb 连接正常，并准备好 TWRP 的刷机包。

2. 安卓设备进入 `bootloader` 。

3. adb 执行刷写 `Recovery` 分区命令。
   
    * **重要！这一部分的详细操作方式视机型和安卓大版本系统架构的不同则完全不同！**

4. 安装完毕后即可重启至 `Recovery` 分区。

**步骤的“第3步”：刷写 `Recovery` 分区命令**，不同的架构需要按照不同的ADB代码刷入，这又是安卓底层分区架构和内核规范演变导致的。

至此，我们又涉及到了一堆屎山代码......

具体的操作细节在第三章：[3.4.1 刷入第三方Recovery（TWRP）](#341-刷入第三方recoverytwrp)

更多扩展内容详见：
> TWRP官网说明，任意已适配的机型都有说明，如小米8：[适用于小米 8 的 TWRP](https://twrp.me/xiaomi/xiaomimi8.html)，但其原版使用说明并不一定适用于第三方TWRP，请自行分辨。
> 
> 个人反复查阅几十遍的启蒙圣经：B站极客湾视频： [「玩机必看！带你入坑安卓刷机，小白也能看懂的ROOT基础指南来啦！」](https://www.bilibili.com/video/BV1BY4y1H7Mc?t=1168)的TWRP部分。
> 
> B站UP主FlashCorpa系列视频之一：[「[系统进阶支线 Vol.2]了解使用TWRP与卡刷教程」](https://www.bilibili.com/video/BV1RX4y1X76z)，较为详细，更加推荐。

### 2.4.2 卡刷 (Recovery Flashing) —— **“强化人”自助换脑复活**

* **定义**：这里特指利用第三方 Recovery 读取内部存储、存储卡甚至是外挂U盘里的 ZIP 包进行安装，不含系统内安装卡刷包的常规情况。  
  
* **优势**：  
  * **便捷**：无需电脑，随时随地可刷（本节初所比喻的扣开脑壳换脑）。
  * **灵活**：适合频繁更换第三方 ROM，毕竟有了TWRP后，胆子就可以稍微大点了。  
  * **保留数据**：在同类系统升级时可选择“脏刷”（不清除 Data），保留软件和记录（不过需要实测，通常仅限小版本或部分大版本之间，比如MIUI升澎湃选择脏刷就容易失败）。  
  
* **劣势**：  
  * 如果 Recovery 本身坏了，这招就废了。  
  * 无法修复底层的分区表错误。  
  
* **操作方式**：

  这一部分本节仅作简述，详细操作方式见下一章（且强烈不建议在没看完本章的情况下直接去照抄！哪怕你跟我同手机型号、同系统版本）。
  1. 将 ROM 包拷入安卓设备;
  2. 重启进 TWRP;
  3. 找到ROM 包路径，点击 Install;
  4. 滑动确认。

### 2.4.3 ADB Sideload —— **外部操控的微型手术机器人**

ADB Sideload 属于介于卡刷与线刷两者之间的“补给线”。

* **定义**：在 Recovery 模式下，通过电脑 ADB 命令直接推送刷机包到设备并安装。  

* **适用场景**：  
  * **Data 分区无法挂载/读取**：这是最常见的 Sideload 需求。当你在 TWRP 里发现无法访问内置存储，无法看到刷机包时，就需要 Sideload。  
  * **无需拷贝**：避免将大文件（如完整 ROM 包）先拷贝到设备内部存储，直接从电脑内存推送安装，节省时间。 
 
* **核心作用**：在内部存储失效的情况下，作为 **“卡刷的替代方案”** 完成 ROM 或补丁的安装。  

* **操作方式**：  
  1. 安卓设备进入 Recovery (如 TWRP)。  
  2. 在 TWRP 界面选择 **高级 ➡️ ADB Sideload** 选项。  
  3. 连接电脑，电脑端在命令行中输入： adb sideload XXX.zip（XXX.zip 为你的刷机包文件名）。

更多细节详见：
> 腾讯云开发者社区专栏： [「第三方rec无法挂载内部存储？——小文教你用ADB 推送刷机包（可root可救砖可刷机）」](https://cloud.tencent.com/developer/article/1152073)
>
> CNDS博主“Ricardoh”的博文： [「adb命令行刷机 使用adb sideload命令推送刷机包到recovery直接刷机Yeah」](https://blog.csdn.net/Ricardoh/article/details/89376603)

### 2.4.4 线刷 (Fastboot / Tool Flashing) —— **“脑死亡尸体”上手术台换脑复活**

* **定义**：安卓设备连接电脑，电脑端工具直接向安卓设备端闪存的各个分区写入镜像文件（img）。  
 
* **优势**：  
  * **救砖神器**：只要安卓设备能进 Fastboot，线刷几乎能解决所有软件层面的砖（上一节所比喻的体外循环系统+超精密手术机械臂）。  
  * **几乎最彻底**：能修复分区表，让安卓设备回归出厂状态。  
  看到这里你应该能够意识到，TWRP等第三方 recovery 就是通过线刷阶段刷入的，尤其是安卓11以后的动态分区机制，线刷之后，TWRP 同样也没了，同样需要重新刷入。

* **劣势**：  
  * **数据全清**：会强制清除所有数据，你需要备份很多东西，而且恢复时也是最麻烦的。
  * **不是最彻底**：麻烦的同时，他并不能修复基带串号、字库等软件层面最严重的错误。
  * **门槛高**：需要配置驱动，需要电脑，需要对应版本的线刷包。
    * 尤其要设备硬件生产商的官方支持，因为线刷基本都要使用官方的线刷工具软件，如果官方使绊子，你就只能祈祷第三方软件可以适配解决线刷问题，如果解决不了，还是完蛋。

* **操作方式**：

  这一部分本节仅作简述，详细操作方式见下一章（且强烈不建议在没看完本章的情况下直接去照抄！哪怕你跟我同手机型号、同系统版本）。
  1. 安卓设备进 Fastboot 模式。
  2. 安卓设备有线连接电脑。
  3. 运行官方工具 (小米MiFlash/三星Odin等)
  4. 刷入。 

### 2.4.5 高通9008模式/MTK深刷模式 —— **近乎于重生的超级人造子宫**

* **定义**：由设备主控芯片制造商（SoC，如高通的骁龙或联发科的MTK）所提供的 **紧急模式**。  
  * **高通模式**：常被称为 EDL (Emergency Download Mode) 或 **9008 模式**（这是电脑设备管理器识别到的端口号）。  
  * **MTK 模式**：通常被称为深刷模式或 Preloader 模式。  

* **地位**：**硬砖（黑砖）的唯一救星**。
  * 当设备无法亮屏、按键无效、电脑无法识别任何 Fastboot 设备时，只有这个模式能让电脑识别到“休克”的设备。  

* **核心作用**：它允许刷入完整的、包含了底层引导程序的官方固件，将设备彻底恢复到出厂时的初始状态。
  * 就像给一个“清零”的硬盘重新写了一遍引导扇区。  

* **工作原理**：如果说 Fastboot 是在设备的“体外循环系统”工作，那 **9008/深刷模式** 就是 **直接介入设备的“主控芯片底层”**。它绕过了所有损坏或失效的软件层（Bootloader、Recovery、system），对设备的最核心、最底层的引导分区（如 eMMC/UFS 闪存的 Partition Table 和 Primary Bootloader）进行读写。 
  * 很像生物学中对 DNA 螺旋直接进行编辑的操作。

* **风险与门槛**：  
  * **门槛极高**：进入模式的方法通常隐秘且复杂（如按住特定组合键插入数据线、拆机短接测试点等），并且需要高度依赖官方的授权工具和底层驱动，很多操作需要极强的动手能力和风险承受能力。  
  * **官方态度**：通常只有官方售后或授权维修点才会使用此模式。第三方泄露的工具或教程往往带有风险，且可能需要付费。对于新手来说，如果到了这一步，除非有极其详尽、高可信度的教程，否则强烈建议放弃自救，寻求专业帮助。

这一部分是所有救砖手段中的 **最终手段**，就像比喻的那样，人造子宫不是随便能获得的神器，现实中，如果有谁真的造出了这样的东西，基本等于直接跨入神明行列，普通人类眼中他都可以算另一个物种；而在刷机领域，9008/MTK深刷的操作同样不是谁都能驾驭的神器。

这也就是为什么我在第二章-第三阶段：搭建生命通道这一节没提9008/MTK深刷，因为新手极难搭建起来这一层的环境，如果能，也用不着看这篇文章了。

一开始我并不太想写这些，但鉴于这一大章节已经写的很完整，那就顺便带一嘴，告诉新手即便彻底刷成黑砖了，也还有招，只不过这一招，就不是谁都可以把握住的，毕竟这只是一个入门向的内容。

不过话也说回来了，如果你 Fastboot 都进不去......这何尝不是一种能力强的表现，毕竟笔者也没有亲自试过，我祈祷这辈子不用这一层的操作......

> PS：本文写到后期，我逐渐意识到，在如今这个厂商极大限制解BL锁的现状下，这是部分设备绕开解锁限制获取 root 权限的手段之一，这就难怪有一部分小白会铤而走险，直接去深刷设备，也只能说，风险自理后果自负了。

更多细节详见：
> 个人反复查阅几十遍的启蒙圣经：B站极客湾视频： [「玩机必看！带你入坑安卓刷机，小白也能看懂的ROOT基础指南来啦！」](https://www.bilibili.com/video/BV1BY4y1H7Mc?t=1168)的最后一部分：救砖。

*以上，第二章 第四阶段（刷入）结束。*

--- 

## 2.5 第五阶段：防砖与急救 —— **亡羊补牢的“术后保险”**

### 2.5.1. 救砖工作量评估 —— **严重性诊断 + 手术规模评估**

根据之前的章节，按照设备受损的情况和挽救余地，补救措施基本可以分为如下这四类：

#### 2.5.1.1 进 TWRP 修改系统文件救砖 —— **轻伤**

* **作用**：解决引导循环等相对不大的问题。

* **特点**：最轻松的措施。

* **备份相关**：不用恢复备份，能在这一步解决的问题，基本都可开机正常使用，接着奏乐接着舞。

* **前提**：
  1. 已提前装好第三方 Recovery（TWRP）。
  2. 能进第三方 Recovery（TWRP）。
  3. 知道是哪些系统文件导致的卡引导循环。

* **操作步骤**：具体问题具体分析，具体症状对应具体的独立操作。

#### 2.5.1.2 恢复出厂设置救砖 —— **中伤**

* **作用**：解决引导循环等相对不大的问题。
  * 为什么不用上一步？因为很多时候的变砖都是属于你不知道自己做了什么，无从对症下药，于是只剩恢复出厂。

* **特点**：不用刷机，只是恢复出厂设置。
  * 当然，这里的“出厂”取决于你刷入的系统ROM，如果你刷入了一些没有出厂预装软件的所谓纯净版系统，那么你恢复出厂设置之后，依旧会是纯净版。

* **备份相关**：需要恢复备份（如果你有的话）。
  * 参照 [2.6 第六阶段：终局备份 —— **制作更强的克隆体**](#27-第六阶段终局备份--制作更强的克隆体)

* **前提**：
  1. 已提前装好第三方 Recovery（TWRP）。
  2. 能进第三方 Recovery（TWRP）。

* **操作步骤**：
  1. 手机重启至TWRP；
  2. TWRP首页 ➡️ `清除` ➡️ 滑动滑块确认恢复出厂;
  3. 重启进系统。

#### 2.5.1.3 重新刷机（卡刷 or 线刷）救砖 —— **重伤**

* **作用**：解决严重的系统损坏、或者上述两种方法都无效的软砖。
  * 比如你刷入了错误的内核导致变砖、无限重启，这时候光恢复出厂已经没用，必须把系统文件重新写入一遍。

* **特点**：最彻底的措施，相当于电脑的“重装系统”。

* **备份相关**：需要恢复备份（如果你有的话）。
  * 参照 [2.6 第六阶段：终局备份 —— **制作更强的克隆体**](#27-第六阶段终局备份--制作更强的克隆体)

* **前提**：
  * 卡刷前提：
    1. 已提前装好第三方 Recovery（TWRP）。
    2. 能进第三方 Recovery（TWRP）。
  * 线刷前提：
    1. Recovery 进不去但还能进 Fastboot/FastbootD 模式。
    2. 一台Windows电脑。
  * 卡刷 or 线刷后还可能要重新刷入TWRP（新rec分区并不独立）

* **操作步骤**：
  * 参照下一章：[第三章：安卓刷机实战流程（以小米12Pro为例）](#第三章安卓刷机实战流程以小米12pro为例)

#### 2.5.1.4 底层救砖（EDL / 9008） —— **濒死**

* **作用**：解决连 Fastboot 都进不去的“黑砖/深砖”。

* **特点**：终极的救命稻草。

* **备份相关**：需要恢复备份（如果你有的话）。
  * 参照 [2.6 第六阶段：终局备份 —— **制作更强的克隆体**](#27-第六阶段终局备份--制作更强的克隆体)

* **前提**：
  1. 硬件没有物理损坏。
  2. 核心硬件数据没有损坏（例如字库没挂，或者挂了有招可恢复）。
  3. 电脑有EDL / 9008相关软件和资源包。
  4. 可能需要拆机短接主板上的测试触点或用工程线来强制进入该模式。

* **操作步骤**：
  * 不做详述，这只是入门文章，如有兴致可请自行学习。

### 2.5.2 搞机风险防控 —— **“术后恢复与疗养禁忌”**

> 鉴于ROOT权限本身就是搞机玩机的核心内容，已经足够单写一本书了，所以本节仅侧重系统权限层面的风险防控和救砖策略，关于和刷机、备份自身相关的“获取ROOT权限”内容详见第三章：[3.4 第四阶段实操：刷入](#34-第四阶段实操刷入) 。

特意奔着刷机而去的极客发烧友终究是少数，绝大多数普通消费者解锁 Bootloader 就是为了获取Root权限，然而 Root 是一把双刃剑，它给了你上帝权限，也给了你毁灭系统稳定性的能力。

**获取Root权限意味着设备的完整性被故意破坏**，举例说明：一旦设备被盗，那么一切就都完了。

因为普通设备被盗，可能以二手硬件的价格被卖出去，最多在最终卖给消费者前被清空数据，然而，二手电子产品流通渠道中的任何一个稍微专业点的从业人员，一旦意识到这是一台获取了Root权限的设备，那就一定会推导出这台设备解锁了bootloader，进而产生获取其中全部数据的想法并大概率付出行动。

如果你的房门24小时都需要敞开着，那最好确保你做到了和需求相配套的安全措施，比如：**安排一个人坐在门口。** 而不是抱着侥幸心理去以普通防盗门的标准，去想当然的要求“门本身就足以发挥防盗作用”。

换个说法，还是拿人体来比喻，只不过这次是手术后，而且还是一定程度上解锁了“超能力”级别生物潜力的手术后：

#### 2.5.2.1 Root 权限 ≈ **神经中枢的最高指挥权**

  * 绕过大脑皮层（系统UI/权限管理）的审核，直接支配全身所有器官（系统文件和应用），能极大增强器官功能，但一旦操作失误，也可以瞬间让大脑崩溃休克（进不去系统）甚至引发全身器官衰竭（部分组件功能异常）。

#### 2.5.2.2 Root 权限管理软件 (如 Magisk ) ≈ **排异抑制剂 + 体内药理师**

  * 如果Root权限级别的操作是各种烈性剧毒/高效药剂，Magisk就是需要严格控制剂量的专业药理师，负责精确地将药物（权限）分发给需要且可靠的“病灶”（应用），确保不会过量并且防止冲动行为（恶意操作）直接损害到整个大脑（系统）。

#### 2.5.2.3 检测 Root 的应用程序(如银行/支付App) ≈ **病毒、寄生器官**

  * 所有会检测你是否处于Root环境的APP都是 **寄生器官**，就像器官移植前必须进行的严苛基因匹配，这些App也利用了这点，它们只接受“原生”或“未被修改”的宿主。

  * 一旦检测到Root的“外来基因标记”（实际上是它发现你有比他更高的权限），立即触发拒绝提供服务（APP进不去），他们会说“来者不善”，是为你的安全着想，所以直接停摆，虽然，实际上，他们才是来者。

#### 2.5.2.4 Root 后的高危操作 —— **标准作死行为举例** 

* **乱删系统文件**：乱删 System 分区下的组件，导致开机校验失败或功能缺失.
  * 例如：使用给予了 Root 权限的文件管理器在 System 或 Vendor 分区下进行删除操作。
  * 例如：操作不当情况下删除温控的行为。 
 
* **修改屏幕分辨率/DPI**：设置了错误的参数，导致 SystemUI 崩溃，黑屏无法操作。 
  * 灯泡永远有人塞嘴里，冬天的铁栏杆永远有人舔，抽屉里永远有人把头卡进去......自然的，“赛博灯泡”必然也会是经久不衰的乐子......

* **超频过载**：使用调度 App 或刷入激进的内核，过度调整 CPU/GPU 频率、电压、或温控策略。
  * **可能的灾难性后果**：轻则设备运行不稳定、过热，极端情况下可能导致硬件降频锁死甚至损坏。

* **刷入不兼容模块**：这是目前最常见的**变砖原因**。  
  * 视觉美化模块：如字体替换、主题美化模块，如果与当前安卓版本或 ROM 界面不兼容，极易导致 UI 持续崩溃。
  * Hosts 文件模块：部分修改 Hosts 文件以屏蔽广告的模块，配置不当可能导致网络完全中断。
  * 核心框架模块：任何涉及修改系统框架的模块，在安装前必须严格核对 ROM 版本兼容性。

* **刷入恶意模块**：上一条的恶意攻击版本。
  * 进了某个资源群/论坛/网站，下载安装了来路不明的模块。
  * **可能的灾难性后果**：系统分区直接被清除，甚至被清除基带字库等分区导致设备报废。
    * 无论对方动机如何，这种赛博投毒的现象是客观存在的，需要严加防范。
  * 更多细节详见：B站UP主FlashCorpa系列视频之一：[[系统进阶支线 Vol.7] 如何防止设备格机
](https://www.bilibili.com/video/BV1zM4m1Z7Wj/)

* **冻结系统组件变砖**：使用“黑域”或“雹”这类工具冻结系统级别的组件，导致重启后变砖。
  * 这种情况基本都是软砖(卡开机动画)。
  * 虽然冻结是阻止后台偷电吃内存等功能的必备操作，但近年来，有太多厂商动歪心思把云控等恶意软件融合进一些系统关键组件里，同样一个系统组件App，某型号加某系统可以冻结，但另外换一个机型或系统便不行，这种厂商无论有意还是无意，这种皆属于埋地雷行为。

本节“Root 后的高危操作”应对方案见实测环节，即下一章：[3.5.2. 高危操作挽救手段 —— **对症下药的针对性治疗**](#253-高危操作挽救手段--对症下药的针对性治疗) 。

*以上，第二章 第五阶段（防砖与急救）结束。*

--- 

## 2.6 第六阶段：终局备份 —— **制作更强的克隆体**

**备份！备份！还是TMD备份！**

这一步的备份，与 [2.1 第一阶段：备份+充满电 —— **制作“克隆体”，然后吃饱饭！**](#21-第一阶段备份充满电--制作克隆体然后吃饱饭)完全不同，第一阶段只是为了保住你基本的前期“资产”（数据）。

而这第六阶段，是为了保住你的“劳动成果”（环境）。

一旦你花费数小时甚至数天刷好了系统、配置好了Root、去除了广告，这时候做一个镜像备份，以后无论怎么折腾，一键就能回到这个完美状态，此时就完全称得上是《Rick and morty》中Rick的 **真·凤凰计划**。

可以实现这一点的有 TWRP 备份、钛备份（Titanium Backup）等，不过钛备份只能备份APP，且只是系统内操作，本文主要介绍 TWRP 备份，更加强大。

### 2.6.1. TWRP 备份的性质

* TWRP备份属于 **“Nandroid备份”**，性质是对安卓设备内部存储器（ NAND 闪存 ）和分区进行完整的系统级快照（类似于镜像），目标是将设备完全还原到备份时的确切状态。
  * 如果你对相关概念开始好奇，推荐Google搜索如下关键词：**“Nandroid 备份”**。

* 虽然 twrp 备份相当底层且彻底，但也是有缺点的： 
  * **有点死板**：镜像备份意味着你不能单独操作某个文件，TWRP 备份本质上是块级的（对分区进行整体备份），每次备份都需要复制整个选定分区的数据，恢复同理。 
  * **体积巨大**：TWRP 备份会占用很多空间，备份前，你的设备空闲容量必须足够，不然只能靠插SD卡/USB-OTG的办法临时扩充容量再想办法导出，恢复同理，空间紧张的时候，恢复时也更麻烦。
  * **几乎没迁移性**：备份文件通常绑定特定手机和特定系统版本，不能跨机型或跨大版本恢复，如果你需要升级系统，最稳的办法是先去尝试安全的系统脏刷手段，升级完之后确保数据可以使用了，再TWRP备份一遍。

### 2.6.2. TWRP 备份前提
若此时你已经刷入了满意的系统，安装了Magisk，获取了root权限，配置好了基本使用习惯，但还未进行各种可能导致变砖的高危操作。

那么这时就可以进行 TWRP 备份了。

毕竟一定会有人直接跳转到这一节阅读，所有有必要列举使用 TWRP 备份的所有大前提：

1. 设备端准备：解锁Bootloader锁，并已获取root权限。
2. Recovery层准备：安卓设备已刷入适配机型和系统版本的 TWRP。
3. PC端准备：已配置好相关环境，详见：[2.3 第三阶段：环境通道搭建 —— **“术前准备”**](#23-第三阶段环境通道搭建--术前准备)
4. PC端准备：已准备好相关救砖用的刷机刷机资源，以及用于存放备份文件数据的空间空间。
5. 保持手机电量充足且不能意外断连（手机fastboot期间不会向电池内充电）。

### 2.6.3. 备份相关核心分区介绍 + TWRP清除操作基本分类 —— **目标病灶确认**

虽然前文已经很长了，但是关于 **“备份”** 的重点知识在这一阶段才步入精华，需要严肃对待。

关于分区，在本文的第一章 [1.5.1. 引导相关核心分区介绍](#151-引导相关核心分区介绍) 已经初步介绍过，而这里详细介绍几个新的分区，也有之前提过分区需要补充，顺便强调一下“双清”、“三清”、“四清”的概念，这属于 twrp 相关操作中的口语化表达，所以有混淆的可能性。

首先，TWRP `清除` 操作中默认滑动滑块以恢复出厂的操作，即清空 **“Data、Chahe分区和Dalvik缓存”**，有些称之为“双清”，也有些称之为“三清”，本文相关部分都会直接描述清楚，而不用“几”清的说法。

其次，无论“几”清，它具体都指的是指 TWRP 中 ➡️ `清除` ➡️ `高级清除` 的几个选项，这些选项每一个都指单独的分区，正好现在细致解释这些分区概念：

#### 2.6.3.1 Cache（系统缓存）

* **作用**：存储临时系统文件，基本无风险。

* **清除不影响用户数据，清除不影响开机。**
  * 清除可救”冻结系统组件变砖”，后文会详述。

#### 2.6.3.2 Dalvik / ART Cache（虚拟机编译缓存）

* **作用**：用于加快应用加载速度，基本无风险。

* 一般在刷入新的 ROM 或更新后可能需要清除，通过强制重新编译来解决部分应用程序崩溃、运行缓慢或启动问题。

* **清除不影响用户数据，清除不影响开机**
  * 但可能造成卡顿，正常运行一段时间 + 多次重启系统即可解决。
  
#### 2.6.3.3 System（系统）
* **作用**：存放 Android 操作系统文件、UI 界面、系统预装 App。  

* **注意！** 部分新机型（安卓10+）可能无法在 TWRP 的清除选项中看到此分区，那是因为 System 分区已经属于 super 分区的一部分了，这点前文有过介绍，详见：[1.5.2.3 动态分区 (Dynamic Partitions / VAB) —— *Android 10+ (主流现状)*](#1523-动态分区-dynamic-partitions--vab--android-10-主流现状)

* **清除后无法开机（需要重新刷入系统），清除不影响用户数据。**
  * 不影响用户数据？这只是理论上的，现实中大量用户数据本身就和系统版本强关联，如果你清除 system 分区后刷入了和原版本号不同的系统甚至新系统，那 Data 分区中的数据是否能保留以及有多少能够正常工作就只能靠实测来验证了。

#### 2.6.3.4 Data（用户数据/真·内部存储）

* **作用**：存放所有的用户数据，包括用户安装的 APP 以及 APP内数据。
  * 系统内卸载APP时，以及清除APP内用户数据时，数据都是从此分区移除的。
  * 这个目录在未获取root权限前无法查看和直接编辑。  

* **加密**：现代安卓强制加密 Data 分区，导致 Recovery 无法直接读取乱码文件，刷机前通常需“格式化 Data”以解密。
  * 部分较新版本的TWPR可解决该问题，但并不是破解，而是独立解决了让你输密码/锁屏图案等操作，如果你没密码，依旧无解只能格式化。 
  * 如果是自己的设备，更简单解决加密问题的操作是系统内不要设置任何的锁屏密码，待所有备份流程走完之后，确定要开始日常使用了，再上密码。

* **注意！** Data 分区并不是存放照片等可以在文件管理器中看到的那个sdcard目录。
  * 至少 **曾经不是**，而现在 **不只是**。
  * 我知道这听起来很乱，但这很重要！具体细节马上会展开讲。
  * 如果你是很旧的设备（安卓4.2之前）则不用担心什么，然而，如果你是新设备，请记住从物理层面来看：
    * **Data 分区本身包括 Sdcard 目录！**
    * **Data 分区本身包括 Sdcard 目录！**
    * **Data 分区本身包括 Sdcard 目录！**
  * 虽然从 TWRP `备份` 功能可以发现，备份选项中的 Data 分区通常都显示为 `Data（不包含存储）` ，这是有过特别强调的。
    * 但是从 TWRP `清除` 功能的角度来解释，即便 **“清除 Data” (Wipe Data / Factory Reset)** 和 **“格式化 Data” (Format Data)** 不一样，但实操过程中，新手稍不留神选了格式化从而抹除 `/Sdcard` 下的数据属于非常常见的情况。 
  * 鉴于使用 TWRP 备份 Data 分区后，备份数据会存在 Sdcard 路径下，所以保守起见，如果要备份 data 分区，备份完毕后，立即将数据导出至其他存储介质，（如PC、实体SD卡或U盘）然后再做其他操作。

* **清除不影响开机，但会清除用户数据 + 恢复出厂设置！**

#### 2.6.3.5 内部存储设备（sdcard分区/公共存储空间/真·外部存储）

* **作用**：用户可见的常规存储空间，例如DCIM文件夹（相机拍摄照片、视频以及截图）、Download文件夹（系统默认下载路径）等数据。
  * 即普通用户直接操作设备时，打开文件管理能看到的最大根目录。
  * 即普通用户导入、导出安卓设备数据时，所能操作的最大根目录。

* **垃圾堆积问题**：按照Google对安卓的规划，各个 App 内部的数据归 data 分区管，并且各个 App 需要存储在 sdcard 分区中的数据也有建议存放路径：`storage/sdcard/Android/data/包名/` ，这样当用户卸载掉App之后，相关的数据会一并删除，本来 sdcard 分区应该是非常的清晰的。
  * 与内部存储（Data 分区）不同的是，当应用程序卸载时，它在外部存储所创建的文件数据不会被清除，因此垃圾就这么产生了。
  * 然而现实中有大量的流氓软件完全不遵守规范开发，日常使用中，这些流氓APP在 sdcard 的根目录也生成了大量的数据！诚然有些是“必要的外部存储占用”，但更多APP则就是单纯随地大小便，甚至是故意的。
  * 这意味着定期手动整理 sdcard 目录，是个非常值得培养的习惯。
  * 毕竟这里是需要备份的重点分区，如果你不清理直接进行无脑备份，很可能最终只是把大量垃圾数据传来传去。

* **注意！** sdcard 到底TMD是“内部存储”还是“外部存储”？？？ 
  * 这取决于参照系。
  * 从普通用户角度，很自然认为是内部，物理层面插进去的存储卡才叫外部。
  * 从开发者角度和谷歌的建议规范来说，毫无疑问是“外部”，因为内部存储指的是 Data 分区。
  * 我知道这听起来很乱，但这很重要！具体细节马上会展开讲。

* **清除不影响用户数据（但会清除所有手动导入设备的数据），清除不影响开机。**

#### 2.6.3.6 USB-OTG（外置USB设备）
  * **作用**：符合 USB 规范的外部插入设备，通常是U盘。
  * 基本属于救急手段时才需要关注的分区。
    * 系统崩了也可以操作外部USB设备中的文件，适用于可以卡刷但是手边却没有电脑、或者无法有线连接电脑的极端情况。
  * 更常见的用途是备份时用于临时扩充存储空间。因为很多安卓设备开始备份时，内部空间已经不足以存放备份文件本身的数据。
    * 不过这一需求可通过ADB有线传输，直接把数据备份到 PC 端。
      * 该功能疑似已被安卓官方弃用，直传备份的功能目前还是可用的，只是当你用新版本的 ADB 进行备份或者还原时，会有一个弃用警告，未来可能失效。
  * 部分TWRP可能会遇到显示 bug，导致 “USB-OTG” 的字母 “O” 显示不全。所以看起来像“CTG”，实际上毫无影响。

关于 **Data（用户数据）** 分区 和 **sdcard（内部存储空间）** 分区的关系，这里需要额外补充，这是又一个安卓大版本更新导致架构大变化，进而造成大量概念混淆的一坨浆糊，真的是屎山代码的典范了......

* 从 `/sdcard` 这个命名就已经埋下了雷，因为早年间的历史遗留问题，在安卓后来的设计演变中，无论设备本身是否有“可移动”的sdcard，安卓自个规范下的“非 data 分区的用户存储”全都叫这个名字，区别无非是设备自带的被定义为了 **“虚拟的sdcard”**，而用户插入的是 **“真实的sdcard”**。

* 但“SD卡” 的大众认知早就是物理层面可插拔的实体卡了，那这概念混淆就几乎是不可避免的。

* 最初 `/sdcard` 路径确实是一个独立分区，但自从安卓 4.2 引入多用户支持后，存储架构经历了重大变革，确立了统一存储系统（Unified Storage System, 简称 UFS）模型。在 UFS 模型下，系统放弃了早期设备中将内部存储空间物理分离为独立挂载点（如 `/sdcard` 或 `/storage/emulated/0`）的做法。

* 如今所有的用户可变数据和媒体文件都集中存储在一个巨大的物理分区内，即 `/data` 分区。从文件系统的角度来看，内部存储数据在物理上确实是 `/data` 分区的一个子目录 (`/data/media/`) 。

更多详细和细致的解释见如下链接：
> Reddit 论坛中一个非常细致讲述此问题的帖子，虽然是十年前的老帖，但他解释的非常完整：[Let's clear up the confusion regarding storage in Android once and for all, including adoptable storage in Marshmallow.](https://www.reddit.com/r/Android/comments/496sn3/lets_clear_up_the_confusion_regarding_storage_in/)
> 
>  这里必须要引用作者其中的一句话（虽然是机翻）：“**安卓的存储系统简直是一场灾难。它居然还能勉强运行，简直是个奇迹。”**  
>
> CSDN作者 “鸽一门” 的博客：[Android内、外存储 易混淆点剖析（/mnt/sdcard、/storage/sdcard0、/storage/emulated/0等区别）
](https://blog.csdn.net/ITermeng/article/details/79423035)，此文于2018年发布，强烈推荐，深入浅出而且细致。
> 
> CSDN作者 “YDimanche” 的博客：[android专题：深度好文！一文读懂android文件存储（支持最新的分区存储）
](https://blog.csdn.net/yu805894501/article/details/148126766)，此文于2025年6月发布，很新，对照前几个链接的内容可以学习的更加彻底。

### 2.6.4 TWRP 备份分区选择

“无脑勾选所有分区”进行备份的时代已经结束了，毕竟已经6202年了，错误的备份策略不仅占用巨大空间，甚至极易导致恢复失败。

TWRP 备份具体需要勾选哪些分区与系统架构高度相关，选对分区是成功的关键，少选了无法开机，多选了浪费空间甚至导致报错。

这里将每一个可能的分区进行列举，**同时也是本文章第三次涉及分区的逐一列举**，此时建议回顾一下之前那两个章节的内容，分别是：

[1.5.1. 引导相关核心分区介绍](#151-引导相关核心分区介绍)，最初只是介绍关键分区的基本概念。

以及 [2.6.3. 备份相关核心分区介绍 + TWRP清除操作基本分类 —— **目标病灶确认**](#261-备份相关核心分区介绍--twrp清除操作基本分类--目标病灶确认)，第二次是新增介绍了几个核心分区的差异和功能，重点强调了清除相关的作用和后果。

而这第三次，侧重点在于强调“不同架构安卓大版本差异”导致 TWRP 备份时有些分区需要 **区别对待** ，请注意必选项 **【✔】**、可选项 **【⚪】**、禁选项 **【❌】** 的标注。

#### 2.6.4.1 Boot (内核)  

* **TWRP 备份性质**：**【✔】必选项【✔】**

* **内容**：Kernel 内核、Ramdisk，决定手机能否启动。

* **关于root权限**：如果提前获取了 root 权限，那么使用 twrp 备份Boot，再恢复回去之后，你依然会拥有 Root 权限，但前提是系统里的 Magisk App （位于 Data 分区）没变化或者同步也恢复了。
  * Root 权限分两部分：一部分在内核里（底层），一部分是系统里的 Magisk 管理器软件（上层），所以恢复root权限仅恢复内核的备份是不够的。

* **TWRP 备份策略选择**：  
  * 对于 **传统分区 （Non-A/B）机型（Android 7.0 及更早）**：
    * 没什么需要强调的，Boot + System + Data 就构成了完整的手机软件环境，恢复时简单粗暴，成功率极高。
  * 对于 **A/B 分区 & VAB 架构（Android 7.0之后至今）**：
    * Recovery 环境实际上寄生在 Boot 分区内，如果不备份 Boot，恢复后你可能会丢失 TWRP 环境。

#### 2.6.4.2 Data (用户数据) 

* **TWRP 备份性质**：**【✔】必选项【✔】**

* **内容**：所有已安装 App、聊天记录、照片、系统设置、桌面布局，这是唯一真正需要频繁备份的“克隆体”，也是 Nandroid Backup 的核心价值。  

* **前提**：TWRP 必须成功解密 Data 分区（能看到乱码以外的正常文件名）。 

* **TWRP 备份策略选择**： 
  * 从备份角度来看，全机型全架构下都无差异的分区，唯一需要强调的是一个 **防“错误255”的设置**：
    * 为避免恢复时出现“错误255”，在 **TWRP 备份界面** 务必点进 **选项** 页,勾选 **启用压缩** 和 **当备份时跳过生成Digest**。  
    * 关于“错误255”，后文会特意补充，详见：[2.8.1 TWRP 无法恢复：255错误](#281-twrp-无法恢复255错误)。

#### 2.6.4.3 System / System Image (系统 / 系统镜像)

* **TWRP 备份性质**：**【⚪】可选项【⚪】**

* **内容**：Android 操作系统本体，存放 Android 操作系统文件、UI 界面、系统预装 App。

* **TWRP 备份策略选择**：  
  * 对于 **传统分区 （Non-A/B）机型（Android 7.0 及更早）**：
    * 直接勾选，没什么需要强调的，Boot + System + Data 就构成了完整的手机软件环境，恢复时简单粗暴，成功率极高。
  * 对于 **A/B 分区机型（Android 7.0 \- 10.0）**：
    * 如果要选，则必须勾选 **System Image**（镜像模式）。严禁勾选 System，因为 A/B 分区的系统文件挂载方式复杂，使用传统的文件级备份 (System) 在恢复时极易出现权限错误或 Slot（槽位）切换失败，使用镜像级备份 (System Image) 则是将整个分区“克隆”，能保证 100% 的一致性。
  * 对于 **动态分区（VAB）机型（Android 10+）**：
    * 完全不建议勾选，TWRP 对动态分区（逻辑分区）的写入支持并不完美，强行恢复 System 经常导致 Fastboot 报错。
      * 某些机型你甚至看不到 System 分区选项，因为包含在Super分区内了。
    * 动态分区 / VAB 机型建议别动 System 分区的心思，系统直接靠电脑线刷，然后再用TWRP 恢复 Data 分区和其他分区，这是最纯粹且省心的。

#### 2.6.4.4 Vendor / Vendor Image (供应商 / 供应商镜像)  

* **TWRP 备份性质**：**【⚪】可选项【⚪】**

* **内容**：SoC 驱动（如骁龙/天玑驱动）、相机底层算法、指纹识别库、传感器驱动，它是硬件与 Android 系统之间的桥梁。  

* **TWRP 备份策略选择**：
  * 如果你刷的是“类原生”系统（Google PixelExperience、LineageOS），它们通常不包含 Vendor，需要你事先有正确的底层，这意味着你需要事先备份。
  * 如果你的 ROM 包带 Vendor，则无需备份。

* **架构差异说明**：  
    * 在 Android 11+ 的机型中，Vendor 往往被包含在 Super 逻辑分区内，TWRP 很难在不备份整个 Super 的情况下单独精准还原 Vendor 镜像，**恢复失败率极高**。  

#### 2.6.4.5 EFS / IMEI / Modem / Persist (底层隐私与基带)

* **TWRP 备份性质**：**【⚪】可选项【⚪】**

* **内容**：IMEI 串号（手机身份证）、MEID、蓝牙地址、WiFi MAC 地址、基带射频参数、校准数据。  
  **特别强调！** 这些是手机出厂时唯一、不可再生的“出生证明”。  

* **TWRP 备份策略选择**：
  * **仅做一次“冷备份”**。建议在第一次刷入 TWRP 后，立即备份并拷贝到电脑/网盘永久保存。  
  * 虽然未必能简单恢复成功，但是有的时候真的能救命。

* **TWRP 未必能恢复这些分区，原因可能有**：  
  * **硬件层锁定**：部分机型（如三星 KNOX、小米某些机型）的 EFS 分区受到硬件级别的保护，TWRP 虽然显示备份成功，但生成的镜像可能是全 0 的空文件。  
  * **恢复崩盘**：**严禁**在日常刷机中频繁恢复这些分区。如果恢复过程中断或校验失败，可能导致手机永久丢失信号（基带未知），甚至无法通过普通的线刷修复。  
  * **蓝牙/WiFi 异常**：如果 Persist 分区损坏，恢复它时若版本不匹配，可能导致 WiFi 按钮无法打开或蓝牙无法配对。

* 基带相关的其他可靠性更高的备份/恢复手段详见：[安卓系统级备份与恢复](https://zhuanlan.zhihu.com/p/561956739)，该文章本阶段文末也有进一步介绍。

#### 2.6.4.6 Super (超级分区)

* **TWRP 备份性质**：**【❌】禁选项【❌】**

* **内容**：动态分区机型中 System + Vendor + Product + Odm 的物理集合体。  

* **禁选理由**：
  * 体积动辄 10GB-15GB 起步，备份和恢复过程极其缓慢，且 TWRP 恢复 Super 分区时，由于它是动态分配空间的逻辑容器，经常会因为块偏移对不上导致手机直接陷入 硬砖。**除非你是高级玩家，非常清楚自己在干什么，否则严禁勾选**。  
    * > 作者自己的小米 12Pro 就是在 TWRP 备份时就自作多情的勾选了 super 分区，妄想恢复的时候一步到位，结果直接搞坏系统，被迫重新线刷卡刷折腾很久，细节见后文：[2.8.1 TWRP 无法恢复：255错误](#281-twrp-无法恢复255错误)。

#### 2.6.4.7 Recovery（恢复分区）

* **TWRP 备份性质**：**【❌】禁选项【❌】**

* **内容**：当前TWRP所在的分区。

* **理由**：逻辑悖论。你正在运行 TWRP，恢复该分区完全等价于重装 TWRP，所以备份它本身没有意义。
    * 况且如果是 A/B 架构，根本不存在独立的 Recovery 分区。  
    * 所以如果有需求，直接重装 TWRP 即可。

#### 2.6.4.8 Cache / Dalvik Cache (缓存)
* **TWRP 备份性质**：**【❌】禁选项【❌】**

* **内容**：系统运行时生成的临时文件。  
  
* **理由**：**完全无需备份**，这些只是电子垃圾，开机后系统会自动重新生成。

TWRP 备份页中显示的可选其余分区还有很多，但与日常备份需求关系不大，如果你自己不懂，千万不要瞎折腾，如果想要进一步深入，这里推荐一篇知乎长文：[安卓系统级备份与恢复](https://zhuanlan.zhihu.com/p/561956739)，作者“OldUncle251”（在B站专栏也有同名文章，排版稍有差异，但暂不确定是同一作者还是抄袭搬运）

* 该文章“1.2.执行备份”一节的列表图片非常直观的列举个各个分区的基本内容，虽然是其作者的个人理解，但对普通人来说够用了。

* 以及其文章中后段详述了 **基带备份/整体ROM备份** 等其他可靠性更高的备份手段，但其内容本文作者并未实测，请各位读者自行评估。

### 2.6.5 TWRP 备份后的数据转移

确定好分区，手动滑动滑块开始备份，等待备份结束后，需要第一时间将备份文件拷贝/转移至其他数据存储设备，如PC/外置SD卡/U盘。

这时候就需要再次强调本章第一阶段提及过的 [2.1.2 手动备份 sdcard 目录](#212-手动备份-sdcard-目录) 问题了。  

TWRP备份的内容总要有地方存放，它会在 `sdcard` 目录下生成一个名为 `TWRP` 的文件夹，备份数据就存放于此，所以到了这一步，需要再次手动备份 sdcard 目录了。
* 当然，如果你的 `sdcard` 路径下除了 `TWRP文件夹` 之外其他内容都没有变化，倒是可以直接拷贝 `TWRP文件夹` 。

关于`sdcard`目录，需务必再次复习这一章节：[2.6.3.5. 内部存储设备（sdcard分区/公共存储空间/真·外部存储）](#2735-内部存储设备sdcard分区公共存储空间真外部存储)

*以上，第二章 第六阶段（终局备份）结束。*

--- 

## 2.7 第七阶段：恢复 —— **复活！**

终于到了最后一步，但是，还没结束，**任何备份手段都有无法还原的可能性，不要觉得备份完就万无一失了，一定要实测可以完整恢复后才能够放心。**

本阶段的重点在于实操过程中的疑难杂症，所以相关内容主要在下一章节展开。

*以上，第二章 全部结束。*

--- 

# 第三章：安卓刷机实战流程 + 疑难杂症解决方案（以小米12Pro为例）

第二章的基本流程仅仅是方法论，而真正的实操，因为有太多个维度的变量，才是千奇百怪问题的深水区！

为了逻辑上的连贯性和一致性，本章大的框架流程参照第二章，但每一阶段的内容会因侧重点的不同而略有差异，也不会再有概念性的解释，而是侧重其每一步的操作步骤和第二章没有展开的针对性细节。

所以整篇文章包的饺子其实就是为了现在这碟醋，本章的实操流程主要以小米 12 Pro 为例，部分流程辅以小米8、小米8SE做验证，如果你的机型和我不同，其内容可用作大体参考，但不保证我所描述的疑难杂症能够涵盖所有情况。

本章具体内容如下：
* [3.0 第零阶段实操：关键信息整理记录](#30-第零阶段实操关键信息整理记录)
* [3.1 第一阶段实操：备份+充满电](#31-第一阶段实操备份充满电)
* [3.2 第二阶段实操：解BL锁](#32-第二阶段实操解bl锁)
* [3.3 第三阶段实操：环境通道搭建](#33-第三阶段实操环境通道搭建)
* [3.4 第四阶段实操：刷入](#34-第四阶段实操刷入)
* [3.5 第五阶段：防砖与急救](#35-第五阶段防砖与急救)
* [3.6 第六阶段：终局备份](#36-第六阶段终局备份)
* [3.7 第七阶段：恢复](#37-第七阶段恢复)

## 3.0 第零阶段实操：关键信息整理记录

在刷机的过程中，有些信息必然需要多次进行复制粘贴，以便搜索、查询和引用，在刷机的摸索时期，新手必定不知道哪些信息是重点/哪些信息需要存档，这就是为什么第二章没有第零阶段。

而现在就不同了，磨刀不误砍柴工，在正式开始之前，我会先将与刷机有关的关键信息尽量进行整理和记录。

### 3.0.1 原始硬件信息（刷机相关）

以下硬件数据皆为设备 **原始硬件信息** ，不含后续可能因维修/改装而变化的数据。

| 硬件编号 | 设备类型 | 设备品牌 | SKU 名称 | 设备型号 | 认证型号 | 设备代号 | Android ABI | 备注 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| 1号设备 | 安卓手机 | 小米 (Xiaomi) | Xiaomi 12 Pro 原野绿（素皮）8GB内存 256GB存储 | Xiaomi 12 Pro 国行版 | 2201122C | zeus | arm64-v8a | 当前主力机 |
| 2号设备 | 安卓手机 | 小米 (Xiaomi) | Xiaomi 8 蓝色 6GB内存 64GB存储 | Xiaomi 8 全网通版 |  M1803E1A | dipper | arm64-v8a | 已退役/备用机 |
| 3号设备 | 安卓电视 | 雷鸟 (FFALCON) | 雷鸟电视 Super 98 | 98S545C PRO |  “未知” | “未知” | arm64-v8a | / |
| ...... | ...... | ...... | ...... | ...... | ...... | ...... | ...... | ...... |

### 3.0.2 当前软件信息（刷机相关）

以下软件数据理论上皆可通过刷机改变，故这里记录的都应该是 **设备当前状态的信息**，如有变更需要及时同步，避免信息错乱误导未来的自己。

| 对应硬件编号 | BL锁 | Recovery | Recovery 版本号 | 操作系统 | 操作系统版本号 | 底层安卓大版本号 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| 1号设备 | 已解 | 第三方（TWRP） | 3.7.0_12-Mi12Pro_v7.9_A13 | MIUI14 国行稳定版 | V14.0.18.0.TLBCNXM | 13.0 | zeus |
| 2号设备 | 已解 | 第三方（TWRP） | ? | MIUI12 国行稳定版 | V12.0.3.0.QEACNXM |  10.0 | dipper |
| ...... | ...... | ...... | ...... | ...... | ...... | ...... |

### 3.0.3 刷机记录

记录刷机的成败、兼容性信息、以及杂项备忘。

| 事件序号 | 对应硬件编号 | 事件性质 | 目标 |相关文件名 | 兼容性 | 备忘 | 
| :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| 1-01 | 1号设备 | 刷第三方Recovery | 能支持的最新TWRP | twrp-3.7.1_12-v9.0_A15-zeus-skkk | **可刷入、触屏无效无法操作** | **SKKK 版 TWRP**、鼠标是否可操作待实测（Type-C鼠标/转接口待采购） |
| 1-02 | 1号设备 | 刷第三方Recovery | 可用的最新TWRP | [REC]3.7.0_12-Mi12Pro_v7.9_A13-zeus-skkk_721f9e75 | 正常使用 | **SKKK 版 TWRP**、当前正在使用的版本 |
| 1-03 | 1号设备 | 刷系统 ROM | 折腾/救砖 | MIUI V14.0.18.0.TLBCNXM | 卡刷/线刷皆成功 | 当前正在使用的版本、冻结列表待优化、隐藏ROOT待优化、第三方输入法待折腾 |
| X-XX | ...... | ...... | ...... | ...... | ...... | ...... |
| 2-02 | 2号设备 | 刷第三方Recovery | TWRP刷入测试 | twrp-3.4.0-10-dipper-mauronofrio | 正常使用 | **mauronofrio版 TWRP、正常使用** |
| 2-01 | 2号设备 | 刷第三方Recovery | 能支持的最新TWRP | twrp-3.7.0_9-0-dipper | 正常使用 | 官方版 TWRP、当前正在使用的版本 |
| X-XX | ...... | ...... | ...... | ...... | ...... | ...... |
| 未来规划 | 任意 | 刷系统 ROM | LineageOS | 待折腾 | 待实测 | 手头机型支持、XDA有现成的ROM包、教程完善 |

*以上，第三章 第零阶段实操（关键信息整理记录）结束。*

--- 

## 3.1 第一阶段实操：备份+充满电

### 3.1.1 系统内备份

MIUI系统内的备份手段为：**“备份与恢复”** 。

#### 3.1.1.1 系统自带备份操作流程：

* 打开 `“设置”APP` ➡️ `我的设备` ➡️ `备份与恢复` ➡️ `手机备份恢复`

**备份时可勾选内容的类别，最好备忘记录标注勾选的内容以便后续恢复；**

* 虽然备份后是多个文件而并不是单一文件，但实际上直接全选后，单次备份时间会更长，即便恢复时会识别出备份了哪些内容；少量多次操作的好处是，当恢复时出现文件损坏或错误时也更好定位筛选和纠错。

#### 3.1.1.2 系统内备份 - 数据迁出流程备忘

备份完成后会生成名为 `日期_编号` 的文件夹，以及 `.XML格式` 的描述文件（该文件可能在文件夹内）；

* 描述文件不是必要的，仅在手机内恢复APP读取备份时用于描述列表、文件名和大小，内容对不上也不影响后续操作。

系统内备份文件存储路径: `内部存储空间\MIUI\Backup\AllBackup\20250210_162504`；

最后【年月日_时分秒】格式命名的文件夹是必须的，不然MIUI内识别不出来。

#### 3.1.1.3 备份文件损坏解决办法

* 一般APP：
  1. 打开 `“设置”APP` ➡️ `我的设备` ➡️ `备份与恢复` ➡️ `手机备份恢复` 。
  2. 将出现错误的app，再次备份一次。（若没安装，安装最新的版本，恢复备份完再降级安装，账号登录与否不重要）
  3. 在手机的目录下，找到最新备份这个app文件，用“无法恢复的文件”替换掉这个文件。
  4. 再次单独恢复该app。

* 微信需特殊处理：
  1. 微信先本体安装Google play版本（版本号8.0.42）。
     * 免登平替版 Google play：[Aurora Store](https://auroraoss.com/) 。
     * 自由开源软件库：[F-Droid](https://f-droid.org/) 。
     * APK镜像站：[APKPure](https://apkpure.com/cn/) 。
     * APK镜像站：[APKMirror](https://www.apkmirror.com/) 。
  2. 安装后直接清除缓存。
  3. 此时将微信再次备份一次。
  4. 在手机的目录下，找到最新备份这个app文件，用“无法恢复的文件”替换掉这个文件。
  5. 再次单独恢复该app。

### 3.1.2 手动备份 sdcard 目录

将设备 /sdcard 目录下的所有文件夹完整迁出，其中包括你手动导入设备的文件。

其中需要特别说明的文件夹：

* DCIM：
  * \DCIM\Camera：相机拍摄照片、视频。
  * \DCIM\Screenshots：截图。

* Download：
  * 系统默认下载路径，几乎所有 App 在未经指定下载目录的情况下都会使用此路径存放下载内容。

* MIUI：
  * \MIUI\backup：系统内备份文件存储路径。
  * \MIUI\Gallery：小米相册的私密相册路径（其中数据已加密）。
  * \MIUI\ringtone：手机铃声。
  * \MIUI\sound_recorder：录音机APP下存储路径。
    * 四个子文件夹:".trash"、"app_rec"、"call_rec"、"fm_rec"都是。

* Pictures：
  * \Pictures\scanner：扫描名片、图转文档所拍摄内容的存储路径。
  * \Pictures\WeiXin：微信的独立图库。

### 3.1.3 数据迁出方式备忘

鉴于大量安卓设备尤其是前些年的旗舰手机都在使用 USB 2.0 的龟速协议，这里比较推荐的办法是安卓设备和电脑处于同一局域网内，使用FTP协议直接无线传输。

* MIIU内置了远程管理功能，可直接使用FTP协议直接无线传输，具体方法：
  1. 打开 `“文件管理”APP` ➡️ 击右上角3个点 `︙` ➡️ `远程管理` ➡️ `启动服务` 。 
      * 右上角设置页，可设置连接手机时使用的用户名与密码，也可勾选 `匿名登录`，但这样任意局域网内设备皆可访问，用完切记在手机上关掉服务。
  2. PC端使用资源管理器，地址栏内输入手机上显示的IP地址，然后便可正常操作。

* 也可使用 **LocalSend** 进行无线传输，支持多文件同时传输，使用WIFI协议，实测基本可以跑满局域网带宽。
  * LocalSend：一款免费、开源、跨平台的局域网文件共享工具，超轻量化，支持Windows、macOS、Linux、Android、iOS。
  * 官网：https://localsend.org/

PC端建议记录备份归档路径。

### 3.1.4 把设备充满电

* 没啥好说的，记得把设备充满电。

*以上，第三章 第一阶段实操（备份+充满电）结束。*

--- 

## 3.2 第二阶段实操：解BL锁

各品牌的各机型请针对性寻找最新的实操方案，若不知从何开始，请复习本文第二章：[2.2 第二阶段：解BL锁 —— **获得“手术资格”**](#22-第二阶段解bl锁--获得手术资格)。

只能算运气好，作者本人搭到了末班车。

23年10月，小米官方正式发布公告，开始收紧 BL解锁政策，解锁前需要先满足在小米社区升到5级 + 答题等新的门槛，而还未升级到澎湃OS (HyperOS)的旧设备依旧还适用MIUI时期的政策直接解锁。

自己手上这台小米 12 Pro，受益于自己几年前还算关注各种系统评测，觉得澎湃1.0功耗控制还不理想，想等一等后续版本，也可能是因为懒，迟迟没有升级，没想到却是因祸得福。

最终通过官方解锁渠道进行申请的时候，已是一年后的2024年年底，当时我的解锁步骤：
 1. PC下载并安装小米官方解锁工具：miflash_unlock。
    * miflash_unlock 小米官方下载页：[解锁小米手机](https://www.miui.com/unlock/download.html)
 2. 打开软件登录小米账号，连接手机，申请解锁。
 3. 完事。

申请后需要等待七天才能解锁，当时我还把这事给忘了，实际上等了一个月后才想起来刷机，具体时间应该是25年1月初，当时“小米高考”已经彻底成为常态，我有幸逃过此劫。

* “小米高考”：
  * 指小米在23年底推出澎湃OS (HyperOS) 后，为了大幅收紧 Bootloader (BL) 解锁权限而设立的一系列极其严格的申请门槛。
  * 因为申请流程不仅需要满足账号等级要求，还要在限定时间内通过一套极高难度的专业知识答题，通过率几乎为零，玩家们戏称其难度堪比“高考”。

作者相信一开始可能真的只是戏称，但随着后续小米 HyperOS 时期的解锁策略逐渐加码，通过限制答题场次、时间、不公开考试通过标准等更多愈发变态甚至堪称耍无赖的手段，使得解锁政策已经演变为了完全的黑箱操作，这一事件在性质上已经从单纯的“技术门槛提升”转变为“用户自主权的高度剥夺”与“品牌社区契约的单方面瓦解”。

高考的公平性毕竟在整个人类文明历史中也算排得上号，而此时若再将小米的解锁限制称之为“小米高考”甚至可以说是对高考的侮辱。

2025年8月30日起，只要升级过澎湃任意版本的老机型一律被封控拉黑锁死，目前还可能不经过社区答题解锁的机型仅剩最新系统不低于 MIUI 12 且从未升级过澎湃OS的设备，例如835、845、855机型，目前小米手机中符合该条件的最新机型为小米13系列。

加上小米内核源码的开源策略发生了变化，小米 12/12 Pro (不含)后的机型源码均无法正常编译或使用，这意味着刷机可折腾的空间极度收缩，在如今看来，小米12系列可以说是各种意义上的末班车。

而25年12月，网络上流出一张小米内部公告截图，其中某高管写到“应安全需求，老机型逐步回收 BL 解锁权限，首先回收小米13全系列”。

写到此处时，回顾整个2025年，小米官方的多种不透明、不告知、不回应的黑箱操作方式，以及陆续拉黑尝试解锁的安卓设备、拉黑绑定的账号甚至拉黑用于解锁的电脑，结合25年11月9日工信部针对各大国产手机厂商发布的某内部征求意见稿，可以看到这是一套非常清晰的温水煮青蛙操作，而锅里的水，目前已经快开了。

只能说，具备解锁条件同时还有想法的各位，抓紧时间吧，祝好运......

> 信息存档：
> 
> B站 2025年04月22日视频：[小米高考？现在的小米还能解锁吗？小米手机解锁规则详解，以及它的过去与现在
](https://www.bilibili.com/video/BV1G252zBE4C/)
>
> B站 2025年11月28日视频：[粗粮老机解锁BL可能彻底关闭！还能解的要尽快了！](https://www.bilibili.com/video/BV1yMSJBpESH/)

*以上，第三章 第二阶段实操（解BL锁）结束。*

--- 

## 3.3 第三阶段实操：环境通道搭建

### 3.3.1 Android SDK Platform-Tools

* Android官网的下载链接：[《SDK 平台工具版本说明》](https://developer.android.com/tools/releases/platform-tools?hl=zh-cn)

### 3.3.2 可选操作：设置 ADB 到 Windows 环境变量

* 配置环境变量目的：
  * 可以在任意位置启动adb，输入相关文件路径时候直接指向文件夹内的文件,而不需要一遍遍复制文件到adb文件夹下。
  * 且今后使用他人分享的 `使用了adb命令的bat脚本` 时不需要再配置/使用附带的adb组件。

* 任意位置启动adb方法：
  * 按住shift后在文件夹内右键，选择 `在此处打开PowerShell`。
  * 或者是 win10 任意路径的资源管理器，直接再地址栏里输 `CMD` + 回车。

* 配置方式：
  1. 下载好 platform-tools 进行解压，定位至安装路径，为行文方便，这里将目录记为 **路径A**。
  2. 电脑端，定位至 `控制面板\系统和安全\系统` 目录下，点击 `高级系统设置` 打开系统属性面板，在 `高级` 选项卡中找到 `环境变量`。
  3. 在 `环境变量` 面板下方的 `系统变量` 中找到名为 `Path` 的变量进行编辑。
  4. 在弹出的 `编辑环境变量` 页面中点击 `新建` 按钮，然后输入ADB文件夹的 **`路径A`** ，一路确定。

* 测试环境变量：
  * 在任意位置打开命令提示符，输入“adb”并回车，如果出现大量提示符并在第三行显示 :
    > Installed as <ADB文件夹地址>\adb.exe 

    就说明我们的adb环境变量设置成功了。
  * 输入 `adb version` 可检测环境是否配置正确。

### 3.3.3 可选操作：下载安装有口皆碑的第三方集成工具

* **搞机工具箱**：
  * 酷安大佬 & B站UP主“晨钟酱”开发，官网：[晨钟网络科技](https://jamcz.com/)
* **柚坛工具箱**：
  * [柚坛论坛](https://www.uotan.cn/) 所开发的工具箱，官网：[Uotan Toolbox](https://toolbox.uotan.cn/)
  * 柚坛工具箱Github仓库：[柚坛工具箱 NT](https://github.com/Uotan-Dev/UotanToolboxNT)

*以上，第三章 第三阶段实操（环境通道搭建）结束。*

--- 

## 3.4 第四阶段实操：刷入

### 3.4.1 线刷第三方Recovery（TWRP） + 顺便获取 ROOT 权限

因为安卓底层分区架构和内核规范不停在演变，Recovery 分区自然也就变成了一坨糨糊中的其中一泡，大体来说 Recovery 分区经历了“分久必合，合久必分”的轮回，从独立分区（A-only） ➡️ 合并分区（A/B） ➡️ 再次独立/分离（GKI/init_boot），这意味着单一操作并不能适用于所有的机型，大概率都需要在这一步做出针对性的调整。

欢迎来到刷机不得不品的又一堆屎山代码......

不过好在经过我查阅多个公开文档 + 数十种 TWRP 刷入教程后，再结合本人无数次反复的测试之后，这里终于可以写出一个尽可能通用的操作步骤。

这套流程的核心思想是：优先尝试直接刷入 (Flash)，不行的话再临时启动 (Boot)，修补 Boot ，然后统一在 TWRP 内部进行固化，最后进系统获取完整的 ROOT 权限，这套操作有点冗余，但是能确保最大兼容性。

* 我的这套步骤也不见得百分之百覆盖所有情况，如果你遇到了我没提到的问题那也非常正常，请自行寻找更加具备针对性的解决方案。

#### 3.4.1.1 安装 TWRP Recovery 步骤

1. 首先设备需要进入 `bootloader` 模式：
    * 设备开机状态下 USB 线连接PC，若弹出 USB 调试权限则设备端点击允许，然后在PC端打开ADB，输入 `adb reboot bootloader` 或者 `adb reboot fastboot` ，此时会直接重启到 fastboot。

2. 重启后显示 “fastboot”，此时可输入 `fastboot devices` 验证ADB是否继续工作。
    * 如果设备正确连接，ADB会输出 “序列号+fastboot” 的字段。

3. 尝试直接刷入TWRP：
    * ADB输入以下命令 `fastboot flash recovery <TWRP文件存放路径>` 。
      * 如果PC端没有事先配置ADB环境，则需要在ADB安装文件夹下存放要拷入的文件，也需要在ADB安装文件夹下通过 CMD 或 PowerShell 打开ADB，若已经配置则随意了，详见上文：[3.3.2 可选操作：设置 ADB 到 Windows 环境变量](#332-可选操作设置-adb-到-windows-环境变量) 。
    * 通常会显示：
      > Sending 'recovery' (XXXXXX KB)                     OKAY [  X.XXXs]
      > 
      > Writing 'recovery'                                 OKAY [  X.XXXs]
      > 
      > Finished. Total time: X.XXXs

      第一行的 `recovery` 若显示为 `recovery_X` 则是当前槽位，不是 `_a` 就是 `_b` ，可以在刷完后进入TWRP，手动选择另一个槽位，然后再次重启到 `FastBoot` 执行一遍以上命令，就可以在A/B槽位都刷入TWRP了。
    * 然后需要输入 `fastboot reboot recovery` 手动重启至 recovery。
    * 如果成功进入 TWRP 界面，则可直接进行第 5 步，不然则进行第 4 步。
      * Xiaomi 12 Pro 实测此步骤可正常刷入。
   
4. 若直接刷入受阻（没重启到 TWRP 而是重启到系统了？作者用 Xiaomi 8 测试便是如此），此时我们尝试将 TWRP 刷入内存，暂时启动到 TWRP Recovery：
    * 先重试前两步，也就是需要再次进入到 `bootloader` 模式。
    * ADB输入：`fastboot boot <TWRP文件存放路径>`，按下回车键后，设备将直接自动重启至 TWRP 界面。
      * 该步基本都不会出问题，就算后面无法固化，至少这种方式可以临时使用 TWRP 。    

5. 设备启动进入 TWRP 后，需要先检查设备是否加密，如果已加密还非要继续操作，则只能格式化数据才能继续。

6. 修补 BOOT 镜像：
    * 将电脑上的 Magisk 文件粘贴到设备上（文件后缀若是.apk格式，文件拷贝至 `/sdcard` 目录前需要先改为.Zip，建议两个后缀的文件都各自拖入进来一份，以备后面步骤使用），TWRP 内点击 `安装` ➡️ 选择刚导入的 Magisk.Zip包。
      * **重要！** 不修补 BOOT 镜像就无法固化 TWRP ，哪怕严格执行所有其他刷入流程，但只要以任何方式进入系统一次，TWRP 就可能被系统默认 Recovery 覆盖掉，所以安装 Magisk 和获取 ROOT 权限最好一并操作完。

7.  TWRP 内的 Magisk 安装完毕后，开始尝试固化：
    * 将电脑上的 TWRP 文件粘贴到设备上（.img格式文件直接拷贝至 `/sdcard` 目录），TWRP 内点击 `安装` ➡️ 选择 `安装镜像` ➡️ 点击刚导入的镜像文件 ➡️ 选择 recovery 分区 ➡️ 滑动确认刷机，切记安装好 TWRP 后，**不要** 立即点 `重启系统`，而是返回到 TWRP 首页。
      * 若点击 `安装` 发现没有 recovery 分区，这是因为采用 A/B 分区方案的设备上，Recovery 被整合进了 Boot 分区，此时需要进入 高级 ➡️ 找到“安装recovery到内存（Install recovery Ramdisk）”选项，点击。
  
8. 返回 TWRP 首页，点击 `重启` ，将设备重启至 Recovery，进入 TWRP 后再次点击 `重启` ，这回将设备重启至系统。

9. 系统内安装 Magisk ，以获取完整 ROOT 权限：
    * 此时系统桌面应该能够找到 Magisk APP，击显示需要下载完整版，不用下载，如果之前第 6 步 拷入了 Magisk.apk 文件，直接安装即可（也可把.Zip后缀的Magisk改回.apk直接安装），安装完毕进入 Magisk 后，若提示完整安装则直接安装，没提示最好在其主界面手动点击完整安装。
    * 完整安装完毕后在 Magisk 界面右上角点击 `重启` 按钮，选择重启至系统。

10. 验证固化是否成功：
    * 手动关机，关机后手动进入 Recovery（小米是按住音量上键 + 电源键），如果直接进入 TWRP 就意味着 TWRP 已永久安装在我们的设备上。

> 更多实操参考来源：[2025 年如何在安卓手机上安装 TWRP Recovery](https://www.youtube.com/watch?v=-dDnH5AvEzY)

#### 3.4.1.2 小米 12 Pro 刷入 TWRP 备忘 + 疑难杂症记录

* 适用于小米 12 Pro 的 TWRP 的下载渠道：

  * XDA发布帖 : skkk 的 TWRP版本: [OFFICIAL TWRP by skkk](https://xdaforums.com/t/shared-official-twrp-by-skkk.4467233/)

**XDA论坛上，skkk 的 TWRP 版本首页的命令说明已经过时，比如Cmd和Power shell命令不同等；这点可能受PC端配置问题影响。**

**例如其中的 `fastboot flash recovery_ab` 命令，同时刷入A、B槽位在本机无法实现。**

**实测记录：**

* **本机（小米12pro）已经测试过无法使用的TWRP版本:**
  * 文件名: `twrp-3.7.1_12-v9.0_A15-zeus-skkk.img` 
  * 下载链接: [Recovery for Xiaomi devices Files](https://sourceforge.net/projects/recovery-for-xiaomi-devices/files/zeus/) 
    > 该版本是作者目前寻找到的支持小米 12 Pro 的最新版本，安装该版本后可正常进入TWRP，但是触摸功能失效，无法操作，初步搜索结果为版本不兼容，只能放弃。
    >
    > 进一步实测证明：无论是直接安装 [REC] 版本，抑或是先安装其他能用的版本再把 [BOOT] 版本传入手机进行升级覆盖，都无法使用触摸功能。
    >
    > 未来或许可进一步测试 Type-C 口外接鼠标能否使用。
    >
    > **备忘！没事别瞎动BOOT**，出问题需要重新刷入原始BOOT文件并重新在TWRP里面刷入面具，然后还要进入系统内再次安装面具！

* **本机（小米12pro）当前使用的TWRP版本:**

  * 文件名：`[REC]3.7.0_12-Mi12Pro_v7.9_A13-zeus-skkk_721f9e75`
  * 该包原始下载链接：[Xiaomi 12 Pro ROM TWRP Files](https://mifirm.net/model/zeus.ttt#twrp)

### 3.4.2 卡刷系统

#### 3.4.2.1 卡刷包下载 

小米刷机包相关网站：
* [XDA 论坛：小米分区](https://xdaforums.com/c/xiaomi.12005/)

* [XiaomiROM.com](https://xiaomirom.com/)
  * 当前小米 12 Pro 国行版 Recovery 卡刷包:
    * 文件名：
      * miui_ZEUS_V14.0.18.0.TLBCNXM_4a0ec88897_13.0
    * 下载页（和线刷包同一个链接）
      * [下载小米 12 Pro (zeus) 稳定版刷机包 MIUI14 V14.0.18.0.TLBCNXM](https://xiaomirom.com/download/xiaomi-12-pro-zeus-stable-V14.0.18.0.TLBCNXM/#china-fastboot)

* 小米手机可在系统更新页面选择下载最新完整包，系统会把卡刷包下载到 /SDcard/download 文件夹。
  * 这个方式只能下载到“官方指定”的最新版本。

#### 3.4.2.2 TWRP 卡刷步骤 

* **定义**：这里特指 Recovery 模式卡刷，也就是利用 TWRP 安装，系统内升级界面安装卡刷包的情况过于常规，这里就不赘述了。

1. 首先设备需要进入 TWRP,以下方法皆可：
    * 开机进入系统后通过 adb 命令让手机直接重启到 `Recovery`，具体命令为 `adb reboot recovery`
    * 开机进入系统后通过使用搞机工具箱等整合软件在电脑端一键操作。
    * 开机进入系统后使用 Magisk 一键操作。
    * 小米：关机状态下 `音量加键` + `电源键` 进入 `Recovery`。
   
2. 将电脑上的 卡刷包 文件粘贴到设备上（.zip格式文件直接拷贝至 /sdcard 目录），TWRP主界面 `安装` ➡️ 点击刚导入的卡刷包 ➡️ 滑动确认刷机。
 
3. 耐心等待3-5分钟刷入完成，点击右下角的重启按钮，重启手机；
 
### 3.4.3 线刷系统

#### 3.4.3.1 线刷包与相关工具下载 

小米刷机包相关网站：

* [XDA 论坛：小米分区](https://xdaforums.com/c/xiaomi.12005/)

* [XiaomiROM.com](https://xiaomirom.com/)
  * 当前小米 12 Pro 国行版 Fastboot 线刷包:
    * 文件名：
      * zeus_images_V14.0.18.0.TLBCNXM_20231221.0000.00_13.0_cn_bef82445c6.tgz
    * 下载页（和卡刷包同一个链接）：
      * [下载小米 12 Pro (zeus) 稳定版刷机包 MIUI14 V14.0.18.0.TLBCNXM](https://xiaomirom.com/download/xiaomi-12-pro-zeus-stable-V14.0.18.0.TLBCNXM/#china-fastboot)

小米线刷工具：

* **MiFlash（小米官方线刷工具）**：
  
  * 作为小米“官方”线刷工具，在2026年的今天甚至已经找不到官方发布渠道，少数官方信息也是指向了MIUI论坛中那些已经打不开的帖子。
    * 目前还能找到的最“官方”的信息留存是小米商城帮助中心页面的其中一则解释页，其中的一个链接直接为文件下载直链，虽然可以直接下载，但其文件是2017年版本。

  * MiFlash的具体功能、使用权限视版本不同而有很大的不同，目前主流的分流站点为 XiaomiROM.com 的 [MiFlash介绍页](https://xiaomirom.com/download-xiaomi-flash-tool-miflash/)
    * 该页面下的最新版本“MiFlash2020-3-14-0.rar”经实测可正常适用于小米 12 Pro 的线刷使用。

  * MiFlash的其他第三方存档：
    * B站UP主（小猴玩机）的专栏文章：[MiFlash 线刷工具下载合集](https://www.bilibili.com/opus/764256406524133383)。
      * **仅作记录，本文作者未下载实测。**
    * 吾爱破解论坛的帖子：[小米刷机工具 MiFlash Prime Edition 2024.08.01](https://www.52pojie.cn/forum.php?mod=viewthread&tid=2046817&extra=&highlight=%D0%A1%C3%D7%2B%CB%A2%BB%FA)
      * **仅作记录，本文作者未下载实测。**


#### 3.4.3.2 线刷包步骤 

1. PC端安装 MiFlash 及驱动并打开。
   
2. 安卓设备需进入 Fastboot 模式。
   
3. 先点击 `加载设备 `，刷机程序会自动识别安卓设备。

4. 准备好线刷包，确认连接无误后选择刷机包路径。
    * **注意！** 有BL锁机型下方默认会选择“全部删除并LOCK”，这意味着刷机成功后会自动回锁 BL 锁。

5. 点击刷机开始刷入，等待刷机完成，MiFlash 内显示success则表示刷机成功，设备会自动开机。

#### 3.4.3.3 线刷疑难杂症 

直接刷机可能会弹出错误：**`Not catch checkpoint`** 。

* **解决方法**：
  * 如果想要避免这个问题，除了使用“全部删除并lock”刷机模式外（注：如果刷海外版固件，请勿选择此刷机模式，不然会因 BL 区域限制无法启动系统），也可以在 MiFlash 配置选项里关闭这个检查。
  * 具体请在菜单栏点击“Configuration”，点击“MiFlash Configuration”，在弹出窗口删除 CheckPoint 里的 \$fastboot -s .*lock 文本。
  *  原始链接：[该B站专栏。](https://www.bilibili.com/read/cv18744586/?jump_opus=1)
   
**注意！** 以上问题解决后仍然可能弹出错误：**`Antirollback check error** 。

* **解决方法**：
  * rom不能包含中文路径，空格等奇怪的字符！
  * 原始链接：[该B站专栏](https://www.bilibili.com/read/cv21866343/?jump_opus=1) **的评论区 （专栏本身的办法很危险）。**

### 3.4.4 手动提取刷机包 BOOT + 获取 ROOT 权限

本条适用于没安装 TWRP 时于系统内使用 Magisk 获取 ROOT 权限的情况。

#### 3.4.4.1 提取 BOOT

线刷包(以及部分卡刷包)：
* 可以直接在包内找到 boot.img文件，拷出即可。

若解压刷机包后发现找不到boot.img文件，则需要解包payload.bin文件，payload.bin文件一般无法直接打开，需要使用payload dumper工具进行解包，步骤如下：

1. 下载并解压 payload-dumper-go 工具，GitHub项目链接：[用 Go 语言编写的 Android OTA payload dumper](https://github.com/ssut/payload-dumper-go)
   
2. 将刷机包中的 payload.bin 移动到解压 payload-dumper-go 的文件夹中。

3. 在资源管理器地址栏里输入 CMD + 回车。

4. 在 cmd 中运行以下命令：`payload-dumper-go.exe payload.bin`。

5. 提取完成后，将创建一个新文件夹，包含所有提取的文件，其中可找到 boot.img 。

> 该教程来源：
> 
> XDA论坛帖子：[[指南]如何使用 payload-dumper-go 从 payload.bin 中提取 img（boot.img 等）。](https://xdaforums.com/t/guide-how-to-extract-img-boot-img-etc-from-payload-bin-using-payload-dumper-go.4468781/)
>
> 该教程已经过本文作者实测可用。

#### 3.4.4.2 修补 BOOT + 手动获取 ROOT 权限

这里使用 Magisk 修补 BOOT 并刷回系统以获取 ROOT 权限。

**修补 BOOT 必须使用当前系统版本的 boot.img 文件，需要严格确认。**
* 不然会卡米（开机卡小米LOGO导致的软砖），救砖去吧。

步骤：

1. 将电脑上的 boot.img 文件粘贴到设备上（.img格式文件直接拷贝至 /sdcard 目录）
2. 系统内打开 Magisk APP，首页点击 `安装` ➡️ 点击 `选择并修补一个文件` ➡️ 点击刚导入的 boot.img 文件 ➡️ 等待修补完成。
   * 修补完成的 boot.img 文件一般会存放于 /SDcard/download 文件夹。
3. 将修补完成的 boot.img 文件拷回PC端。
4. 设备需重启至 `fastboot` 模式，PC端使用 ADB 输入 fastboot 命令：`fastboot falsh boot <修补后 boot.img 文件存放路径>`

### 3.4.5 高通9008

尚未尝试，略。

> 无意间刷到的一个工具：刷机匣：
> 
> 宣传视频：[刷机匣-全新图形化深刷工具-哔哩哔哩](
https://www.bilibili.com/video/BV1Cd2yB1E7U?t=12)
> 
> 酷安发布贴：[刷机匣-全新图形化深刷工具](https://www.coolapk.com/feed/67202734?s=ZWY4YzE2YTEzMTdhNmVnNjkzMjhmMGN6i1581)
>
> 注：该工具本文作者未经实测，请自行评估。

*以上，第三章 第四阶段实操（刷入）结束。*

--- 

## 3.5 第五阶段：防砖与急救

### 3.5.1. 救砖工作量评估

救砖工作量评估参照第二章相关内容：[2.5.1. 救砖工作量评估 —— **严重性诊断 + 手术规模评估**](#251-救砖工作量评估--严重性诊断--手术规模评估)

这里没有特别需要补充的。

### 3.5.2. 高危操作挽救手段 —— **对症下药的针对性治疗**

虽然备份永远是最靠谱的手段，但有些问题确实不用大动干戈也可以解决，这一步算是终极备份前的最后小妙招：

#### 3.5.2.1 安装“防砖模块”

* 各种防砖模块的基本工作原理是：当它检测到系统启动失败次数过多时，会自动禁用所有 Magisk 模块，从而强制开机。
  * 要注意“防砖模块”下载源是否安全。 
  
#### 3.5.2.2 掌握 ADB 救急指令

* 如果因为模块导致卡开机动画，不要急着双清。  
  * 连接电脑，在 CMD 输入：adb wait-for-device shell magisk \--remove-modules  
  * 这行命令会强行删除所有模块，往往能瞬间救回安卓设备。   
  
该解决方案来自于XDA论坛帖子：[【指南】 用于启动 Magisk 仅核心模式的 Magisk 模块禁用程序](https://xdaforums.com/t/guide-magisk-modules-disabler-for-booting-into-magisk-core-only-mode.3990557/)

#### 3.5.2.3 安全模式大法

* 部分安卓设备在开机动画时按住音量键可以进入“安全模式”。
  * 此模式下 Magisk 模块通常不加载，方便你卸载问题模块。

#### 3.5.2.4 TWRP救“冻结”变砖

这条专指“冻结”系统组件变砖，避免“格式化data分区”的解决方案：

* 使用TWRP删除系统文件中冻结列表（前提是TWRP可正常读取安卓设备data分区内的数据设备，通常安卓系统内不设置锁屏密码便不会加密data分区）
  1. 手机重启至TWRP；
  2. TWRP首页 ➡️ `高级选项` ➡️ `文件管理` ➡️ `进入路径`：`/data/system/users/0/` ;
  3. 删除 `package-restrictions.xml` 文件。
       * 若无权限则返回TWRP首页 ➡️ `清除` ➡️ `高级清除` ➡️ 仅勾选`Cache`  ➡️ 滑动操作清除缓存分区，此时 `package-restrictions.xml` 文件同样会被删除。
       * 若使用过手机分身/双开应用，路径：`/data/system/users/999/` 下同样有 `package-restrictions.xml` 文件，也需删除。
  4. 重启进系统。
  
  > 该解决方案经过本文作者本人验证，来自于：
  > 
  > B站UP主“可爱的小潇潇
”的视频：[手贱冻结不知名程序 卡米了怎么保留数据开机(收藏备用)
](https://www.bilibili.com/video/BV1444y157kH/)
  > 
  > 以及该链接：[小米、红米救砖冻结卡米解决方案](https://outlela.com/share/184.html)

*以上，第三章 第五阶段实操（防砖与急救）结束。*

--- 

## 3.6 第六阶段：终局备份

在第二章，这是最复杂的部分之一，不过，在事先解释时罗列的足够清晰之后，实操部分就非常简单了：

### 3.6.1 小米 12 Pro TWRP 备份步骤

1. 首先设备需要进入 TWRP,以下方法皆可：
    * 开机进入系统后通过 adb 命令让手机直接重启到 `Recovery`，具体命令为 `adb reboot recovery`
    * 开机进入系统后通过使用搞机工具箱等整合软件在电脑端一键操作。
    * 开机进入系统后使用 Magisk 一键操作。
    * 小米：关机状态下 `音量加键` + `电源键` 进入 `Recovery`。

2. TWRP首页 ➡️ `备份` 菜单 ➡️ 先点选 `选项` 选项卡，勾选 **启用压缩** 和 **当备份时跳过生成Digest**。
    * 重要，尤其需要是勾选 **当备份时跳过生成Digest**，详见后文：[3.7.1 TWRP 无法恢复：255错误](#371-twrp-无法恢复255错误)

3. 回到 `备份` 选项卡，在“选择要备份的分区”中选择要备份的分区。
    * 小米12 pro 的常规选择选择为 Boot 分区 + Data 分区。

4. 滑动滑块确认备份。

### 3.6.2 TWRP 备份后的数据转移（个人备忘）

 TWRP 备份文件存储在选择的存储位置/TWRP/BACKUPS/<设备ID>/<备份时间>文件夹下，这些文件只能通过TWRP恢复。

安卓设备内默认位置举例：`/sdcard/TWRP/BACKUPS/serialno/2025-02-10--21-49-49/`

作者个人习惯刷选择单独拷贝至PC进行归档，存放位置与手动导入的文件夹/sdcard备份平级而不是放于/sdcard路径下。

### 3.6.3 TWRP 备份boot/system分区说明

TWRP备份可顺便勾选 `boot` 分区，备份boot分区可以在无限fb，无限重启，卡开机的时候还原boot分区，一般可以解决。

**boot分区每个版本一一对应！并不通用！**

**需要确保备份前后系统版本一致！所以备份boot分区切记记录版本号。**

* 同时备份system分区并归档在一起，恢复的时候一并恢复回去，这样就不用线刷救砖，更省事？
  * 除非是安卓9.0之前的系统，不然不建议这么干！
  * 自己的小米 12 PRO 一年前就是不熟悉架构差异，为图省事备份了system分区，后恢复实操时因恢复system分区失败而变砖，后反而只能靠线刷救砖。
  * **小米12 PRO 其底层为安卓13,存在 `super` 分区(动态分区概念)：**
    > 自Android Q(10.0)以后，系统支持动态分区（dynamic partition），它将多个系统只读分区（包括system、product、vendor、odm或者其他厂商自定义分区）合并为一个super分区。物理分区只有super分区的概念，而没有system等分区。因此使用fastboot刷机时，是无法直接通过命令：
    > 
    > `fastboot flash system system.img`
    > 
    > 进行刷机的，而只能刷写super分区：
    > 
    > `fastboot flash super super.img`
    > 
    > super分区不区分A/B槽，一个super分区中包含了A、B两套只读分区，并且其中的只读分区也不需要显式指定分区大小，因为他们是在用户态中动态分配挂载的，只要这些只读分区的总大小不超过super分区的物理大小即可。

  `fastboot -w` 命令请不要使用，它和 `super` 分区不兼容，使用之后会导致系统无法启动，手机变砖。

* 小米12 PRO 使用 TWRP 备份前不要设置锁屏密码！
  * 主要是为了避免遇到的 TWRP 解密 Data分区 失败问题。
  * 相关原始链接：[点击此处](https://android.stackexchange.com/questions/231415/how-to-decrypt-island-work-profile-and-parallel-apps-user-in-twrp)

### 3.6.4 PC端直接通过 adb 命令进行 TWRP 备份说明

该功能疑似已弃用。

备份的功能还是可用的。只是当你用新版本的 ADB 进行备份或者还原时，会有一个弃用警告，这就像 Android 大部分被废弃的 Api 一样，虽然被标记废弃，但是依然可用。

不过既然被标记为废弃，那么这个功能就可能在未来的 Android 系统中被去掉。

原始链接：[用 TWRP「一键 Ghost」你的 Android 手机，还能备份到电脑](https://sspai.com/post/41705)

*以上，第三章 第六阶段实操（终局备份）结束。*

--- 

## 3.7 第七阶段：恢复

和备份类似，恢复可能出现的问题相对麻烦，而恢复阶段本身的步骤则很简单：

1. 首先设备需要进入 TWRP,以下方法皆可：
    * 开机进入系统后通过 adb 命令让手机直接重启到 `Recovery`，具体命令为 `adb reboot recovery`
    * 开机进入系统后通过使用搞机工具箱等整合软件在电脑端一键操作。
    * 开机进入系统后使用 Magisk 一键操作。
    * 小米：关机状态下 `音量加键` + `电源键` 进入 `Recovery`。

2. 提前将准备恢复的 TWRP 恢复文件拷入设备。
    * 需要使用 ADB 传输数据的情况下可以使用如下命令：
       
      `adb push <TWRP备份文件存放路径> /sdcard/TWRP`

3. TWRP首页 ➡️ `恢复` 菜单 ➡️ 点选 需要恢复的文件，然后等待恢复完毕。

### 3.7.1 TWRP 无法恢复：255错误

经过作者大量的资料查询，TWRP 备份失败在很多情况下都会提示“255错误”，哪怕只是刷完系统后直接恢复 Data 和 Boot 分区。

其原因包括但不限于：

* 双开应用、系统分身导致加密校验异常；
* 系统版本不兼容；
* TWRP 版本不兼容；
* TWRP 无法识别分区加密；
* 备份文件损坏。

然而无论具体原因是什么，本文作者最终实测出一个比较通用的万能解决方案：

该方案其本质是彻底清理干净相关分区数据 + 卡刷系统 + 恢复，所以前提准备是 **已刷入适配你设备同时尽可能新版本的TWRP** + **已准备好卡刷包 ROM（需要和备份时的系统版本完全一致）**。

我将具体步骤拆解如下：

1. TWRP首页 ➡️ `设置` ➡️ 勾选两个选项：`使用rm - rf格式化` + `跳过摘要生成` ;

2. 返回TWRP首页 ➡️ `擦除` ➡️ `高级擦除` ➡️ 勾选4个分区：`Dalvlk / ART Cache` + `Cache` + `System` + `Data` ➡️ 滑动擦除；

3. 返回TWRP首页 ➡️ `设置` ➡️ `文件管理` ➡️ 进入路径 `/Data`，除了第二个文件夹 `media` 之外（ `media` 文件夹包含我们的内部存储），手动删除所有其他文件夹，操作方式为进入需要操作的文件夹内 ➡️ 点右下角勾号按钮 ➡️ `Delete` ➡️ 滑动删除。

4. 以上删除操作执行后，继续进入路径 `/Data/media/obb`，同样手动执行删除 `obb` 文件夹。

5. 以上删除操作执行后，继续进入路径 `/Data/media/0/Android`，同样手动执行删除 `Android` 文件夹。

6. 返回TWRP首页 ➡️ `安装` ➡️ 进入要恢复备份的 ROM 路径 ➡️ 选择和备份时版本完全一致的 ROM 卡刷包 ➡️ 滑动刷入。
    * 如果你需要 root 权限，记得刷完 ROM 后顺便注入 Magisk。

7. 系统 ROM 安装完成后，立即重启至系统，初始化时一切设置从简，一直点下一步，能跳过的步骤都跳过，不要连接wifi或任何网络，不要设置密码和指纹，进入UI主界面后，便可重启至 Recovery，具体操作方法以下皆可：
    * 开机进入系统后通过adb命令让手机直接重启到 `Recovery`，具体命令为 `adb reboot recovery`
    * 使用柚坛工具箱等整合软件在电脑端一键操作。
    * 小米：关机状态下 `音量加键` + `电源键` 进入 `Recovery`。

8. 进入TWRP后，TWRP首页 ➡️ `恢复` ➡️ 进入要恢复备份文件路径 ➡️ 点击要恢复的备份 ➡️ 勾选 `Boot` 分区 + `Data` 分区。
    * 即便你事先备份了 `System` 分区或 `Super` 分区，这一步也不要勾选，不要勾选，不要勾选。

9.  滑动恢复按钮，等待 TWRP 执行完毕。
    * 如果你的 ROM 包未预装 Google官方应用程序和服务套件，同时你后来手动安装过，然后又用 TWRP 备份了，这时候你就需要在 TWRP 恢复执行完毕时，手动刷入 GApps 包（如 Open GApps），然后再进系统。

10. 返回TWRP首页 ➡️ `重启`  ➡️ 重启至系统，验证恢复是否成功。

为了避免以后 TWRP 备份时出现类似 **255错误** 的问题，需牢记该细节：
* 备份时无论需要勾选哪些分区，在 **TWRP 备份界面** 务必点进 **选项** 页,勾选 **启用压缩** 和 **当备份时跳过生成Digest**。

> 该方案来自于这个6年前的油管视频：[Error restoring backup "extractTarFork() process ended with ERROR: 255" | Error 255 In TWRP Recovery
](https://www.youtube.com/watch?v=hPeKu--_myc)
> 
> 我只是将这个视频的内容整理总结并排版成文字稿。
> 
> 在我遇到 **255错误** 问题后，翻遍全网各种头疼医头脚疼医脚的方案，最终是这个视频救了作者的手机命。
> 
> 简中互联网天天嘲讽印度阿三，可真到这种实操性的软件工程问题上，他们输出的有价值内容并不少。

### 3.7.2 TWRP 恢复后的“锁屏密码”陷阱
当你使用 TWRP 恢复了 Data 分区，重启进入系统后，可能发现指纹失效，且输入 **正确的锁屏密码** 也被提示错误，无法解锁。  

* **原因**：安卓的安全芯片 (TEE/Gatekeeper) 发现数据分区发生了底层变动，出于安全保护锁死了密钥。  
* **解法**：  
  1. 重启回 TWRP。  
  2. 进入 Advanced (高级) ➡️ File Manager (文件管理)。  
  3. 进入路径：/data/system/。  
  4. **删除**以下类型文件：  
        * locksettings.db  
        * \*.key (所有后缀为 .key 的文件)  
        * gatekeeper.\*  
  5. 重启手机，此时屏幕锁已被清除，直接滑动解锁即可，进系统后再重新录入指纹密码。 

> 该解决方案来自于CSDN作者 “玩机达人88” 的博客文章：[使用TWRP-recovery恢复系统后，开机密码不正确怎么办
](https://blog.csdn.net/romleyuan/article/details/100026548)
>
> 本文作者并未遇到该问题，只是查资料的时候，发现不少人曾经遇到过，所以列举出来，具体效果还需实测。

*以上，第三章 全部结束。*

--- 

# 写在最后

最后是一些废话，毕竟前面哔哔太多，总要收个尾。

我是一个比较轴的人。

写这篇文章花了约一个月时间，远远超过自己最初的预期，而且，从头到尾自己的脑海中都有无数个声音在提醒我：

* **“别折腾了，有必要吗？不过就是一篇小众、冷门的攻略罢了，有几个人会去看啊？”**

* **“刷机行为本身都快绝迹了，你这家伙到底在指望些什么啊？”**

我为什么要刷机呢？或许仅仅是又一个重度数据洁癖者的自嗨，但随着文章脉络越来越清晰，流程测试的次数越来越多，我逐渐意识到自己在干什么了，我逐渐意识到曾经自己的浮躁是多么需要被审视。

十几岁时的我，当时发现一个现象：

无论一个科技成就多么的宏大，无论一种技术实现多么的精妙和不可思议，只要他被普及到大众中去了，就必然会被绝大多数人所漠视。

就好像那些信手拈来的“方便”，是大众们自己努力的结果，细问他们真的干了什么吗？

答案是，他们什么都没干，一帮被裹挟着的韭菜罢了，绝大多数人自以为占着便宜，实际上全都是被卖了都还在帮别人数钱的小丑。

这逐渐催生出了自己内心深处一个根深蒂固的信念：

**会被绝大多数人所漠视的东西，必然会被绝少数人所利用。**

**所以越是大众所漠视的东西，我越要当回事。**

这甚至直接改变了自己的人生轨迹，我扔掉了太多别人眼中梦寐以求的东西。

五年前的自己，曾经写下过这样一段话：
> 网上冲浪时间越久，越需要在最终面对一个事实：
> 
> **价值本身是会腐烂的。**
> 
> “是金子总会发光”是一个彻头彻尾的笑话。
> 
> 无论多么耀眼的东西，终将随着时间被掩埋；
> 
> 苹果砸头是奇迹，烂在地里才是常态。
> 
> 真正的金子，只有主动挖掘、碰到满鼻子灰，才有可能获得冰山一角。
> 
> 直接糊到脸上的东西，除了风雨，只有传单。这是一种必然。
> 
> 上面只有转了不知道多少手的扭曲信息碎片、和深加工后塞满了私货的垃圾大礼包。
> 
> 可怕的是，把这些垃圾作为自己人生中主要信息获取渠道的人，不在少数。

后来这段话受到了很多人的点赞、引用、转发，这进一步鼓励了自己的审慎，以及坚定支持了自己长期拒绝和排斥很多低级趣味的人生抉择是多么正确。

然而，我并不是在传播真理，只是描述了一段现状罢了，无非这“一段”的时间跨度略微有些长，大约是所有可追溯至今的人类历史。

司空见惯，从来不代表天经地义。

人人都知道“磨刀不误砍柴工”，而持续数十年“磨刀上瘾”的我，却把“利刃”当成了一种司空见惯，我完全没有兴趣去对待那些磨好的刀，甚至不懂得利用和变现。

某一个瞬间，我才意识到，自己长期处于一种轻浮且不接地气的精神状态中。

此时再回过头来看看最开始的那个问题：

* **别折腾了，有必要吗？不过就是一篇小众、冷门的攻略罢了，有几个人会去看啊？**

回想自己之前挖掘过的绝大多数资料，有几个不是小众？有几个不够冷门？整个互联网有多少真正有价值的碎片，不都是安安静静躺在点击量几百甚至只有几十的互联网角落？

回想自己意识到整个简中互联网没有任何一篇文章、一个视频、一个帖子可以清晰完整的解释尤其是详细实操验证解决“ TWRP 备份 255错误”的时候，那是一个太阳马上升起的清晨，窗帘自动打开时射进来的阳光甚至让我有些烦躁，而当时面无表情的我打开了 YouTube ，甚至没过脑子，条件反射般的输入了“TWRP ERROR 255”并尝试搜索，然后依旧面无表情的打开双语翻译，开始啃视频内容。

实测可以解决问题时，我如释重负，长舒一口气，然后我干了什么呢？

答案是，我什么都没有干，我关闭了视频，开始挖掘下一个问题。

我甚至没给那个视频点个赞。

巧了的是，在写下最后这一段时，刚好也是一个太阳刚刚升起的清晨，明明也是直射的阳光，但我却觉得没那么刺眼。

白嫖是问题吗？从来都不是。

生米恩，斗米仇，真把白嫖当白菜，那才是问题。

全文最开头的时候我说过什么来着：我绝不能成为儿时自己眼中的那些油腻中年人...

多少伟大的开源项目构成了这个世界，甚至构成了我的前半生。

有太多想整的活还没有整，每次想到这一点时，也会同步蹦出来太多的借口和理由，而从这篇文章正式发布之后，动力又多了一条：

也该轮到别人开始白嫖我的时候了。

全文完。

---